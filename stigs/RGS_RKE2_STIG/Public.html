<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/4473ecc91f70f139-s.p.woff" as="font" crossorigin="" type="font/woff"/><link rel="preload" href="/_next/static/media/463dafcda517f24f-s.p.woff" as="font" crossorigin="" type="font/woff"/><link rel="stylesheet" href="/_next/static/css/704a2760ecb090f6.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-9f9d947a63484a6e.js"/><script src="/_next/static/chunks/4bd1b696-13501251b672eaff.js" async=""></script><script src="/_next/static/chunks/684-ec2154760e36e555.js" async=""></script><script src="/_next/static/chunks/main-app-e5294125788cd7de.js" async=""></script><script src="/_next/static/chunks/167-1b0faf1b73f1083f.js" async=""></script><script src="/_next/static/chunks/967-21d88758be072729.js" async=""></script><script src="/_next/static/chunks/app/stigs/%5Bstig_id%5D/%5Bclassification%5D/page-f5a2fd719d00911b.js" async=""></script><meta name="next-size-adjust" content=""/><script src="/service-worker.js"></script><title>STIGs | Rancher Government Solutions RKE2 Security Technical Implementation Guide | Public</title><meta name="description" content="This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DOD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents. Comments or proposed revisions to this document should be sent via email to the following address: disa.stig_spt@mail.mil."/><meta name="application-name" content="STIGUI"/><meta name="keywords" content="Release: 3 Benchmark Date: 30 Jan 2025,3.5,1.10.0,Public"/><meta name="creator" content="DISA"/><meta name="publisher" content="DISA"/><meta property="og:title" content="STIGs | Rancher Government Solutions RKE2 Security Technical Implementation Guide | Public"/><meta property="og:description" content="This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DOD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents. Comments or proposed revisions to this document should be sent via email to the following address: disa.stig_spt@mail.mil."/><meta property="og:url" content="https://stig.neal.codes/stigs/RGS_RKE2_STIG"/><meta property="og:site_name" content="STIGUI"/><meta property="og:type" content="article"/><meta property="article:published_time" content="2024-12-20T00:00:00.000Z"/><meta property="article:author" content="DISA"/><meta property="article:tag" content="Release: 3 Benchmark Date: 30 Jan 2025"/><meta property="article:tag" content="3.5"/><meta property="article:tag" content="1.10.0"/><meta property="article:tag" content="Public"/><meta name="twitter:card" content="summary"/><meta name="twitter:title" content="STIGs | Rancher Government Solutions RKE2 Security Technical Implementation Guide | Public"/><meta name="twitter:description" content="This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DOD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents. Comments or proposed revisions to this document should be sent via email to the following address: disa.stig_spt@mail.mil."/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="16x16"/><script>document.querySelectorAll('body link[rel="icon"], body link[rel="apple-touch-icon"]').forEach(el => document.head.appendChild(el))</script><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="__variable_1e4310 __variable_c3aa02 antialiased dark:bg-zinc-900 dark:text-zinc-100"><nav class="bg-white dark:bg-zinc-900 fixed w-full z-20 top-0 start-0 border-b border-zinc-200 dark:border-zinc-700"><div class="max-w-screen-xl flex flex-wrap items-center justify-between mx-auto p-4"><a href="/" class="flex items-center space-x-3 rtl:space-x-reverse" tabindex="100"><span class="self-center text-2xl font-semibold whitespace-nowrap dark:text-white">STIGUI</span></a><div class="flex md:order-2 space-x-3 md:space-x-0 rtl:space-x-reverse"><div class="relative inline-block text-left"><div><button type="button" class="inline-flex w-full justify-center gap-x-1.5 rounded-md bg-transparent px-3 py-2 text-sm font-semibold text-zinc-500 shadow-sm" id="menu-button" aria-expanded="true" aria-haspopup="true"><svg width="20" height="20" viewBox="0 0 30 30" xmlns="http://www.w3.org/2000/svg" fill="currentColor" aria-hidden="true" data-slot="icon"><rect width="30" height="3"></rect><rect y="9" width="30" height="3"></rect><rect y="18" width="30" height="3"></rect></svg></button></div></div></div></div></nav><div class="grid grid-rows-[20px_1fr_20px] items-center justify-items-center p-8 md:p-6 max-sm:p-2 pb-20 gap-16 font-[family-name:var(--font-geist-sans)]"><main class="flex flex-col gap-8 row-start-2 items-center sm:items-start max-w-screen-xl"><!--$--><aside class="flex flex-row items-center justify-start w-full"><span><a class="text-sm text-zinc-400" tabindex="60" href="/stigs">STIGs</a><span class="text-sm mx-2 text-zinc-300"> <!-- -->&gt;<!-- --> </span></span><span><a class="text-sm text-zinc-400" tabindex="60" href="/stigs/RGS_RKE2_STIG">Rancher Government Solutions RKE2</a></span></aside><h1 class="text-3xl mt-6">Rancher Government Solutions RKE2 Security Technical Implementation Guide</h1><p class="text-base discussion">This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DOD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents. Comments or proposed revisions to this document should be sent via email to the following address: disa.stig_spt@mail.mil.</p><section class="text-zinc-600 dark:text-zinc-500 text-xs w-full flex justify-between items-center"><aside class="inline-flex rounded-md shadow-xs" role="group"><a class="px-4 py-2 text-sm font-medium text-zinc-900 border-zinc-200 hover:bg-zinc-100 hover:text-blue-700 focus:z-10 focus:ring-2 focus:ring-blue-700 focus:text-blue-700  dark:border-zinc-700 dark:text-white dark:hover:text-white dark:hover:bg-zinc-700 dark:focus:ring-blue-500 dark:focus:text-white dark:bg-zinc-500 bg-zinc-200 rounded-s-lg border border-t border-b" href="/stigs/RGS_RKE2_STIG/Public">Public</a><a class="px-4 py-2 text-sm font-medium text-zinc-900 border-zinc-200 hover:bg-zinc-100 hover:text-blue-700 focus:z-10 focus:ring-2 focus:ring-blue-700 focus:text-blue-700  dark:border-zinc-700 dark:text-white dark:hover:text-white dark:hover:bg-zinc-700 dark:focus:ring-blue-500 dark:focus:text-white dark:bg-zinc-800 bg-white border-t border-b border-t border-b" href="/stigs/RGS_RKE2_STIG/Classified">Classified</a><a class="px-4 py-2 text-sm font-medium text-zinc-900 border-zinc-200 hover:bg-zinc-100 hover:text-blue-700 focus:z-10 focus:ring-2 focus:ring-blue-700 focus:text-blue-700  dark:border-zinc-700 dark:text-white dark:hover:text-white dark:hover:bg-zinc-700 dark:focus:ring-blue-500 dark:focus:text-white dark:bg-zinc-800 bg-white border-t border-b rounded-e-lg border" href="/stigs/RGS_RKE2_STIG/Sensitive">Sensitive</a></aside><div class="text-zinc-600 dark:text-zinc-500 text-xs flex flex-col align-end text-end"><span>Date: <!-- -->2024-12-20</span><span>Version: <!-- -->2</span></div></section><section class="w-full flex justify-between items-center"><div><button class="text-sm max-sm:text-xs font-medium me-2 px-2.5 py-0.5 rounded-sm bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300"><span>high</span><span class="text-xs ml-1">7</span></button><button class="text-sm max-sm:text-xs font-medium me-2 px-2.5 py-0.5 rounded-sm bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-300"><span>medium</span><span class="text-xs ml-1">17</span></button></div><div class="text-zinc-600 dark:text-zinc-500 text-xs flex"><button class="text-zinc-600 dark:text-zinc-500 text-xs flex flex-col mr-4">XML</button><button class="text-zinc-600 dark:text-zinc-500 text-xs flex flex-col mr-4">JSON</button><button class="text-zinc-600 dark:text-zinc-500 text-xs flex flex-col">CSV</button></div></section><section class="w-full flex flex-col"><div class="relative overflow-x-auto shadow-md sm:rounded-lg"><form><table class="w-full text-sm text-left rtl:text-right text-zinc-500 dark:text-zinc-400"><thead class="text-xs text-zinc-700 uppercase bg-zinc-50 dark:bg-zinc-700 dark:text-zinc-400"><tr><th scope="col" class="px-6 py-3 uppercase " data-searchable="true"><div class="flex items-center"><button type="button" class="flex items-center text-xs text-zinc-700 uppercase bg-zinc-50 dark:bg-zinc-700 dark:text-zinc-300">Group ID<input type="hidden" name="orders_0" value="asc"/><svg class="w-4 h-4 ms-1" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path class="" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m12 5 4 4-4-4-4 4"></path><path class="dark:stroke-zinc-500 stroke-zinc-100" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m12 19 4-4-4 4-4-4"></path></svg></button></div></th><th scope="col" class="px-6 py-3 uppercase text-center" data-searchable="true"><div class="flex items-center"><button type="button" class="flex items-center text-xs text-zinc-700 uppercase bg-zinc-50 dark:bg-zinc-700 dark:text-zinc-300">Severity<input type="hidden" name="orders_1" value="desc"/><svg class="w-4 h-4 ms-1" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path class="dark:stroke-zinc-500 stroke-zinc-100" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m12 5 4 4-4-4-4 4"></path><path class="" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m12 19 4-4-4 4-4-4"></path></svg></button></div></th><th scope="col" class="px-6 py-3 uppercase " data-searchable="true"><div class="flex items-center"><button type="button" class="flex items-center text-xs text-zinc-700 uppercase bg-zinc-50 dark:bg-zinc-700 dark:text-zinc-300">Title<input type="hidden" name="orders_2" value="none"/><svg class="w-4 h-4 ms-1" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path class="dark:stroke-zinc-500 stroke-zinc-100" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m12 5 4 4-4-4-4 4"></path><path class="dark:stroke-zinc-500 stroke-zinc-100" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m12 19 4-4-4 4-4-4"></path></svg></button><span class="ml-4"><input type="text" class="w-full px-2 py-1 text-xs text-zinc-700 bg-zinc-50 dark:bg-zinc-900 dark:text-zinc-400 border border-zinc-300 dark:border-zinc-700 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Filter Title" name="searches_2"/></span></div></th><th scope="col" class="px-6 py-3 uppercase max-lg:hidden" data-searchable="true"><div class="flex items-center"><span class="text-xs text-zinc-700 uppercase bg-zinc-50 dark:bg-zinc-700 dark:text-zinc-300">Description</span><span class="ml-4"><input type="text" class="w-full px-2 py-1 text-xs text-zinc-700 bg-zinc-50 dark:bg-zinc-900 dark:text-zinc-400 border border-zinc-300 dark:border-zinc-700 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Filter Description" name="searches_3"/></span></div></th></tr></thead><tbody><tr class="odd:bg-white odd:dark:bg-zinc-900 even:bg-zinc-50 even:dark:bg-zinc-800 border-b dark:border-zinc-700 border-zinc-200"><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line "><a class="flex flex-col whitespace-nowrap" href="/stigs/RGS_RKE2_STIG/groups/V-254553">V-254553</a></td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line "><span class="text-sm max-sm:text-xs font-medium me-2 px-2.5 py-0.5 rounded-sm bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300"><span>high</span></span></td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line ">Rancher RKE2 must protect authenticity of communications sessions with the use of FIPS-validated 140-2 or 140-3 security requirements for cryptographic modules.</td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line max-lg:hidden">Use strong TLS settings.

RKE2 uses FIPS validated BoringCrypto modules. RKE2 Server can prohibit the use of SSL and unauthorized versions of TLS protocols to properly secure communication. There is a lot of traffic between RKE2 nodes to deploy, update, and delete resources so it is important to set strong TLS settings on top of this default feature. It is also important to use approved cypher suites. This ensures the protection of the transmitted information, confidentiality, and integrity so that the attacker cannot read or alter this communication.

The use of unsupported protocol exposes vulnerabilities to the Kubernetes by rogue traffic interceptions, man-in-the-middle attacks, and impersonation of users or services from the container platform runtime, registry, and key store.

To enable the enforcement of minimum version of TLS and cipher suites to be used by the various components of RKE2, the settings &quot;tls-min-version&quot; and &quot;tls-cipher-suites&quot; must be set.

Further documentation of the FIPS modules can be found here: https://docs.rke2.io/security/fips_support.

Satisfies: SRG-APP-000014-CTR-000035, SRG-APP-000014-CTR-000040, SRG-APP-000219-CTR-000550, SRG-APP-000441-CTR-001090, SRG-APP-000442-CTR-001095, SRG-APP-000514-CTR-001315, SRG-APP-000560-CTR-001340, SRG-APP-000605-CTR-001380, SRG-APP-000610-CTR-001385, SRG-APP-000635-CTR-001405, SRG-APP-000645-CTR-001410</td></tr><tr class="odd:bg-white odd:dark:bg-zinc-900 even:bg-zinc-50 even:dark:bg-zinc-800 border-b dark:border-zinc-700 border-zinc-200"><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line "><a class="flex flex-col whitespace-nowrap" href="/stigs/RGS_RKE2_STIG/groups/V-254558">V-254558</a></td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line "><span class="text-sm max-sm:text-xs font-medium me-2 px-2.5 py-0.5 rounded-sm bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300"><span>high</span></span></td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line ">The Kubernetes API server must have the insecure port flag disabled.</td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line max-lg:hidden">By default, the API server will listen on two ports. One port is the secure port and the other port is called the &quot;localhost port&quot;. This port is also called the &quot;insecure port&quot;, port 8080. Any requests to this port bypass authentication and authorization checks. If this port is left open, anyone who gains access to the host on which the master is running can bypass all authorization and authentication mechanisms put in place, and have full control over the entire cluster.

Close the insecure port by setting the API server&#x27;s --insecure-port flag to &quot;0&quot;, ensuring that the --insecure-bind-address is not set.</td></tr><tr class="odd:bg-white odd:dark:bg-zinc-900 even:bg-zinc-50 even:dark:bg-zinc-800 border-b dark:border-zinc-700 border-zinc-200"><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line "><a class="flex flex-col whitespace-nowrap" href="/stigs/RGS_RKE2_STIG/groups/V-254559">V-254559</a></td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line "><span class="text-sm max-sm:text-xs font-medium me-2 px-2.5 py-0.5 rounded-sm bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300"><span>high</span></span></td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line ">The Kubernetes Kubelet must have the read-only port flag disabled.</td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line max-lg:hidden">Kubelet serves a small REST API with read access to port 10255. The read-only port for Kubernetes provides no authentication or authorization security control. Providing unrestricted access on port 10255 exposes Kubernetes pods and containers to malicious attacks or compromise. Port 10255 is deprecated and should be disabled. 

Close the read-only-port by setting the API server&#x27;s read-only port flag to &quot;0&quot;.</td></tr><tr class="odd:bg-white odd:dark:bg-zinc-900 even:bg-zinc-50 even:dark:bg-zinc-800 border-b dark:border-zinc-700 border-zinc-200"><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line "><a class="flex flex-col whitespace-nowrap" href="/stigs/RGS_RKE2_STIG/groups/V-254560">V-254560</a></td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line "><span class="text-sm max-sm:text-xs font-medium me-2 px-2.5 py-0.5 rounded-sm bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300"><span>high</span></span></td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line ">The Kubernetes API server must have the insecure bind address not set.</td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line max-lg:hidden">By default, the API server will listen on two ports and addresses. One address is the secure address and the other address is called the &quot;insecure bind&quot; address and is set by default to localhost. Any requests to this address bypass authentication and authorization checks. If this insecure bind address is set to localhost, anyone who gains access to the host on which the master is running can bypass all authorization and authentication mechanisms put in place and have full control over the entire cluster.

Close or set the insecure bind address by setting the API server&#x27;s --insecure-bind-address flag to an IP or leave it unset and ensure that the --insecure-bind-port is not set.</td></tr><tr class="odd:bg-white odd:dark:bg-zinc-900 even:bg-zinc-50 even:dark:bg-zinc-800 border-b dark:border-zinc-700 border-zinc-200"><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line "><a class="flex flex-col whitespace-nowrap" href="/stigs/RGS_RKE2_STIG/groups/V-254561">V-254561</a></td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line "><span class="text-sm max-sm:text-xs font-medium me-2 px-2.5 py-0.5 rounded-sm bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300"><span>high</span></span></td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line ">The Kubernetes kubelet must enable explicit authorization.</td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line max-lg:hidden">Kubelet is the primary agent on each node. The API server communicates with each kubelet to perform tasks such as starting/stopping pods. By default, kubelets allow all authenticated requests, even anonymous ones, without requiring any authorization checks from the API server. This default behavior bypasses any authorization controls put in place to limit what users may perform within the Kubernetes cluster. To change this behavior, the default setting of AlwaysAllow for the authorization mode must be set to &quot;Webhook&quot;.</td></tr><tr class="odd:bg-white odd:dark:bg-zinc-900 even:bg-zinc-50 even:dark:bg-zinc-800 border-b dark:border-zinc-700 border-zinc-200"><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line "><a class="flex flex-col whitespace-nowrap" href="/stigs/RGS_RKE2_STIG/groups/V-254562">V-254562</a></td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line "><span class="text-sm max-sm:text-xs font-medium me-2 px-2.5 py-0.5 rounded-sm bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300"><span>high</span></span></td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line ">The Kubernetes API server must have anonymous authentication disabled.</td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line max-lg:hidden">The Kubernetes API Server controls Kubernetes via an API interface. A user who has access to the API essentially has root access to the entire Kubernetes cluster. To control access, users must be authenticated and authorized. By allowing anonymous connections, the controls put in place to secure the API can be bypassed.

Setting anonymous authentication to &quot;false&quot; also disables unauthenticated requests from kubelets.

While there are instances where anonymous connections may be needed (e.g., health checks) and Role-Based Access Controls (RBAC) are in place to limit the anonymous access, this access should be disabled, and only enabled when necessary.</td></tr><tr class="odd:bg-white odd:dark:bg-zinc-900 even:bg-zinc-50 even:dark:bg-zinc-800 border-b dark:border-zinc-700 border-zinc-200"><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line "><a class="flex flex-col whitespace-nowrap" href="/stigs/RGS_RKE2_STIG/groups/V-254573">V-254573</a></td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line "><span class="text-sm max-sm:text-xs font-medium me-2 px-2.5 py-0.5 rounded-sm bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300"><span>high</span></span></td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line ">Rancher RKE2 keystore must implement encryption to prevent unauthorized disclosure of information at rest within Rancher RKE2.</td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line max-lg:hidden">Encrypting secrets at rest in etcd.

By default, RKE2 will create an encryption key and configuration file and pass these to the Kubernetes API server. The result is that RKE2 automatically encrypts Kubernetes Secret objects when writing them to etcd.</td></tr><tr class="odd:bg-white odd:dark:bg-zinc-900 even:bg-zinc-50 even:dark:bg-zinc-800 border-b dark:border-zinc-700 border-zinc-200"><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line "><a class="flex flex-col whitespace-nowrap" href="/stigs/RGS_RKE2_STIG/groups/V-254554">V-254554</a></td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line "><span class="text-sm max-sm:text-xs font-medium me-2 px-2.5 py-0.5 rounded-sm bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-300"><span>medium</span></span></td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line ">RKE2 must use a centralized user management solution to support account management functions.</td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line max-lg:hidden">The Kubernetes Controller Manager is a background process that embeds core control loops regulating cluster system state through the API Server. Every process executed in a pod has an associated service account. By default, service accounts use the same credentials for authentication. Implementing the default settings poses a high risk to the Kubernetes Controller Manager. Setting the use-service-account-credential value lowers the attack surface by generating unique service accounts settings for each controller instance.</td></tr><tr class="odd:bg-white odd:dark:bg-zinc-900 even:bg-zinc-50 even:dark:bg-zinc-800 border-b dark:border-zinc-700 border-zinc-200"><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line "><a class="flex flex-col whitespace-nowrap" href="/stigs/RGS_RKE2_STIG/groups/V-254555">V-254555</a></td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line "><span class="text-sm max-sm:text-xs font-medium me-2 px-2.5 py-0.5 rounded-sm bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-300"><span>medium</span></span></td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line ">Rancher RKE2 components must be configured in accordance with the security configuration settings based on DOD security configuration or implementation guidance, including SRGs, STIGs, NSA configuration guides, CTOs, and DTMs.</td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line max-lg:hidden">Once an attacker establishes access to a system, the attacker often attempts to create a persistent method of re-establishing access. One way to accomplish this is for the attacker to modify an existing account. Auditing of account creation is one method for mitigating this risk. A comprehensive account management process will ensure an audit trail documents the creation of application user accounts and, as required, notifies administrators and/or application when accounts are created. Such a process greatly reduces the risk that accounts will be surreptitiously created and provides logging that can be used for forensic purposes.

Within Rancher RKE2, audit data can be generated from any of the deployed container platform components. This audit data is important when there are issues, such as security incidents, that must be investigated. To make the audit data worthwhile for the investigation of events, it is necessary to know where within the container platform the event occurred.

To address access requirements, many application developers choose to integrate their applications with enterprise-level authentication/access/auditing mechanisms that meet or exceed access control policy requirements. Such integration allows the application developer to offload those access control functions and focus on core application features and functionality.

Satisfies: SRG-APP-000026-CTR-000070, SRG-APP-000027-CTR-000075, SRG-APP-000028-CTR-000080, SRG-APP-000092-CTR-000165, SRG-APP-000095-CTR-000170, SRG-APP-000096-CTR-000175, SRG-APP-000097-CTR-000180, SRG-APP-000098-CTR-000185, SRG-APP-000099-CTR-000190, SRG-APP-000100-CTR-000195, SRG-APP-000101-CTR-000205, SRG-APP-000319-CTR-000745, SRG-APP-000320-CTR-000750, SRG-APP-000343-CTR-000780, SRG-APP-000358-CTR-000805, SRG-APP-000374-CTR-000865, SRG-APP-000375-CTR-000870, SRG-APP-000381-CTR-000905, SRG-APP-000409-CTR-000990, SRG-APP-000492-CTR-001220, SRG-APP-000493-CTR-001225, SRG-APP-000494-CTR-001230, SRG-APP-000495-CTR-001235, SRG-APP-000496-CTR-001240, SRG-APP-000497-CTR-001245, SRG-APP-000498-CTR-001250, SRG-APP-000499-CTR-001255, SRG-APP-000500-CTR-001260, SRG-APP-000501-CTR-001265, SRG-APP-000502-CTR-001270, SRG-APP-000503-CTR-001275, SRG-APP-000504-CTR-001280, SRG-APP-000505-CTR-001285, SRG-APP-000506-CTR-001290, SRG-APP-000507-CTR-001295, SRG-APP-000508-CTR-001300, SRG-APP-000509-CTR-001305, SRG-APP-000510-CTR-001310, SRG-APP-000516-CTR-000790, SRG-APP-00516-CTR-001325</td></tr><tr class="odd:bg-white odd:dark:bg-zinc-900 even:bg-zinc-50 even:dark:bg-zinc-800 border-b dark:border-zinc-700 border-zinc-200"><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line "><a class="flex flex-col whitespace-nowrap" href="/stigs/RGS_RKE2_STIG/groups/V-254556">V-254556</a></td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line "><span class="text-sm max-sm:text-xs font-medium me-2 px-2.5 py-0.5 rounded-sm bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-300"><span>medium</span></span></td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line ">The Kubernetes Controller Manager must have secure binding.</td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line max-lg:hidden">Limiting the number of attack vectors and implementing authentication and encryption on the endpoints available to external sources is paramount when securing the overall Kubernetes cluster. The Controller Manager API service exposes port 10252/TCP by default for health and metrics information use. This port does not encrypt or authenticate connections. If this port is exposed externally, an attacker can use this port to attack the entire Kubernetes cluster. By setting the bind address to only localhost (i.e., 127.0.0.1), only those internal services that require health and metrics information can access the Control Manager API.</td></tr><tr class="odd:bg-white odd:dark:bg-zinc-900 even:bg-zinc-50 even:dark:bg-zinc-800 border-b dark:border-zinc-700 border-zinc-200"><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line "><a class="flex flex-col whitespace-nowrap" href="/stigs/RGS_RKE2_STIG/groups/V-254557">V-254557</a></td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line "><span class="text-sm max-sm:text-xs font-medium me-2 px-2.5 py-0.5 rounded-sm bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-300"><span>medium</span></span></td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line ">The Kubernetes Kubelet must have anonymous authentication disabled.</td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line max-lg:hidden">RKE2 registry is used to store images and is the keeper of truth for trusted images within the platform. To guarantee the images&#x27; integrity, access to the registry must be limited to those individuals who need to perform tasks to the images such as the update, creation, or deletion. Without this control access, images can be deleted that are in use by RKE2 causing a denial of service (DoS), and images can be modified or introduced without going through the testing and validation process allowing for the intentional or unintentional introduction of containers with flaws and vulnerabilities.

By allowing anonymous connections, the controls put in place to secure the Kubelet can be bypassed. Setting anonymous authentication to &quot;false&quot; also disables unauthenticated requests from kubelets.

While there are instances where anonymous connections may be needed (e.g., health checks) and Role-Based Access Controls (RBAC) are in place to limit the anonymous access, this access must be disabled and only enabled when necessary.</td></tr><tr class="odd:bg-white odd:dark:bg-zinc-900 even:bg-zinc-50 even:dark:bg-zinc-800 border-b dark:border-zinc-700 border-zinc-200"><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line "><a class="flex flex-col whitespace-nowrap" href="/stigs/RGS_RKE2_STIG/groups/V-254563">V-254563</a></td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line "><span class="text-sm max-sm:text-xs font-medium me-2 px-2.5 py-0.5 rounded-sm bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-300"><span>medium</span></span></td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line ">All audit records must identify any containers associated with the event within Rancher RKE2.</td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line max-lg:hidden">Ensure that the --audit-log-maxage argument is set to 30 or as appropriate.

Retaining logs for at least 30 days ensures that you can go back in time and investigate or correlate any events. Set your audit log retention period to 30 days or as per your business requirements.
Result: Pass</td></tr><tr class="odd:bg-white odd:dark:bg-zinc-900 even:bg-zinc-50 even:dark:bg-zinc-800 border-b dark:border-zinc-700 border-zinc-200"><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line "><a class="flex flex-col whitespace-nowrap" href="/stigs/RGS_RKE2_STIG/groups/V-254564">V-254564</a></td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line "><span class="text-sm max-sm:text-xs font-medium me-2 px-2.5 py-0.5 rounded-sm bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-300"><span>medium</span></span></td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line ">Configuration and authentication files for Rancher RKE2 must be protected.</td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line max-lg:hidden">There are various configuration files, logs, access credentials, and other files stored on the host filesystem that contain sensitive information. 

These files could potentially put at risk, along with other specific workloads and components:
- API server.
- proxy.
- scheduler.
- controller.
- etcd.
- Kubernetes administrator account information.
- audit log access, modification, and deletion.
- application access, modification, and deletion.
- container runtime files.

If an attacker can gain access to these files, changes can be made to open vulnerabilities and bypass user authorizations inherent within Kubernetes with RBAC implemented. It is crucial to ensure user permissions are enforced down through to the operating system. Protecting file permissions will ensure that if a nonprivileged user gains access to the system they will still not be able to access protected information from the cluster API, cluster configuration, and sensitive cluster information. This control relies on the underlying operating system also having been properly configured to allow only least privileged access to perform required operations.

Satisfies: SRG-APP-000133-CTR-000300, SRG-APP-000133-CTR-000295, SRG-APP-000133-CTR-000305, SRG-APP-000133-CTR-000310</td></tr><tr class="odd:bg-white odd:dark:bg-zinc-900 even:bg-zinc-50 even:dark:bg-zinc-800 border-b dark:border-zinc-700 border-zinc-200"><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line "><a class="flex flex-col whitespace-nowrap" href="/stigs/RGS_RKE2_STIG/groups/V-254565">V-254565</a></td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line "><span class="text-sm max-sm:text-xs font-medium me-2 px-2.5 py-0.5 rounded-sm bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-300"><span>medium</span></span></td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line ">Rancher RKE2 must be configured with only essential configurations.</td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line max-lg:hidden">It is important to disable any unnecessary components to reduce any potential attack surfaces. 

RKE2 allows disabling the following components:
- rke2-canal
- rke2-coredns
- rke2-ingress-nginx
- rke2-kube-proxy
- rke2-metrics-server

If utilizing any of these components presents a security risk, or if any of the components are not required then they can be disabled by using the &quot;disable&quot; flag.

If any of the components are not required, they can be disabled by using the &quot;disable&quot; flag.

Satisfies: SRG-APP-000141-CTR-000315, SRG-APP-000384-CTR-000915</td></tr><tr class="odd:bg-white odd:dark:bg-zinc-900 even:bg-zinc-50 even:dark:bg-zinc-800 border-b dark:border-zinc-700 border-zinc-200"><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line "><a class="flex flex-col whitespace-nowrap" href="/stigs/RGS_RKE2_STIG/groups/V-254566">V-254566</a></td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line "><span class="text-sm max-sm:text-xs font-medium me-2 px-2.5 py-0.5 rounded-sm bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-300"><span>medium</span></span></td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line ">Rancher RKE2 runtime must enforce ports, protocols, and services that adhere to the PPSM CAL.</td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line max-lg:hidden">Ports, protocols, and services within the RKE2 runtime must be controlled and conform to the PPSM CAL. Those ports, protocols, and services that fall outside the PPSM CAL must be blocked by the runtime. Instructions on the PPSM can be found in DOD Instruction 8551.01 Policy.

RKE2 sets most ports and services configuration upon initiation; however, these ports can be changed after the fact to noncompliant configurations. It is important to verify core component configurations for compliance.

API Server, Scheduler, Controller, ETCD, and User Pods should all be checked to ensure proper PPS configuration.

Satisfies: SRG-APP-000142-CTR-000325, SRG-APP-000142-CTR-000330, SRG-APP-000383-CTR-000910</td></tr><tr class="odd:bg-white odd:dark:bg-zinc-900 even:bg-zinc-50 even:dark:bg-zinc-800 border-b dark:border-zinc-700 border-zinc-200"><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line "><a class="flex flex-col whitespace-nowrap" href="/stigs/RGS_RKE2_STIG/groups/V-254567">V-254567</a></td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line "><span class="text-sm max-sm:text-xs font-medium me-2 px-2.5 py-0.5 rounded-sm bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-300"><span>medium</span></span></td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line ">Rancher RKE2 must store only cryptographic representations of passwords.</td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line max-lg:hidden">Secrets, such as passwords, keys, tokens, and certificates should not be stored as environment variables. These environment variables are accessible inside RKE2 by the &quot;Get Pod&quot; API call, and by any system, such as CI/CD pipeline, which has access to the definition file of the container. Secrets must be mounted from files or stored within password vaults.</td></tr><tr class="odd:bg-white odd:dark:bg-zinc-900 even:bg-zinc-50 even:dark:bg-zinc-800 border-b dark:border-zinc-700 border-zinc-200"><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line "><a class="flex flex-col whitespace-nowrap" href="/stigs/RGS_RKE2_STIG/groups/V-254568">V-254568</a></td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line "><span class="text-sm max-sm:text-xs font-medium me-2 px-2.5 py-0.5 rounded-sm bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-300"><span>medium</span></span></td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line ">Rancher RKE2 must terminate all network connections associated with a communications session at the end of the session, or as follows: for in-band management sessions (privileged sessions), the session must be terminated after five minutes of inactivity.</td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line max-lg:hidden">Terminating an idle session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended. In addition, quickly terminating an idle session will also free up resources committed by the managed network element. 

Terminating network connections associated with communications sessions includes, for example, de-allocating associated TCP/IP address/port pairs at the operating system level, or de-allocating networking assignments at the application level if multiple application sessions are using a single, operating-system-level network connection. This does not mean that the application terminates all sessions or network access; it only ends the inactive session and releases the resources associated with that session.</td></tr><tr class="odd:bg-white odd:dark:bg-zinc-900 even:bg-zinc-50 even:dark:bg-zinc-800 border-b dark:border-zinc-700 border-zinc-200"><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line "><a class="flex flex-col whitespace-nowrap" href="/stigs/RGS_RKE2_STIG/groups/V-254569">V-254569</a></td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line "><span class="text-sm max-sm:text-xs font-medium me-2 px-2.5 py-0.5 rounded-sm bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-300"><span>medium</span></span></td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line ">Rancher RKE2 runtime must isolate security functions from nonsecurity functions.</td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line max-lg:hidden">RKE2 runs as isolated as possible.

RKE2 is a container-based Kubernetes distribution. A container image is essentially a complete and executable version of an application, which relies only on the host&#x27;s OS kernel. Running containers use resource isolation features in the OS kernel, such as cgroups in Linux, to run multiple independent containers on the same OS. Unless part of the core RKE2 system or configured explicitly, containers managed by RKE2 should not have access to host resources.

Proper hardening of the surrounding environment is independent of RKE2 but ensures overall security stature.

When Kubernetes launches a container, there are several mechanisms available to ensure complete deployments:
- When a primary container process fails it is destroyed rebooted.
- When Liveness checks fail for the container deployment it is destroyed rebooted.
- If a readiness check fails at any point after the deployment the container is destroyed rebooted.
- Kubernetes has the ability to rollback a deployment configuration to a previous state if a deployment fails.
- Failover traffic to a working replica if any of the previous problems are encountered.

System kernel is responsible for memory, disk, and task management. The kernel provides a gateway between the system hardware and software. Kubernetes requires kernel access to allocate resources to the Control Plane. Threat actors that penetrate the system kernel can inject malicious code or hijack the Kubernetes architecture. It is vital to implement protections through Kubernetes components to reduce the attack surface.</td></tr><tr class="odd:bg-white odd:dark:bg-zinc-900 even:bg-zinc-50 even:dark:bg-zinc-800 border-b dark:border-zinc-700 border-zinc-200"><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line "><a class="flex flex-col whitespace-nowrap" href="/stigs/RGS_RKE2_STIG/groups/V-254570">V-254570</a></td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line "><span class="text-sm max-sm:text-xs font-medium me-2 px-2.5 py-0.5 rounded-sm bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-300"><span>medium</span></span></td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line ">Rancher RKE2 runtime must maintain separate execution domains for each container by assigning each container a separate address space to prevent unauthorized and unintended information transfer via shared system resources.</td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line max-lg:hidden">Separating user functionality from management functionality is a requirement for all the components within the Kubernetes Control Plane. Without the separation, users may have access to management functions that can degrade the Kubernetes architecture and the services being offered, and can offer a method to bypass testing and validation of functions before introduced into a production environment.

Satisfies: SRG-APP-000243-CTR-000600, SRG-APP-000431-CTR-001065, SRG-APP-000211-CTR-000530, SRG-APP-000243-CTR-000595</td></tr><tr class="odd:bg-white odd:dark:bg-zinc-900 even:bg-zinc-50 even:dark:bg-zinc-800 border-b dark:border-zinc-700 border-zinc-200"><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line "><a class="flex flex-col whitespace-nowrap" href="/stigs/RGS_RKE2_STIG/groups/V-254571">V-254571</a></td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line "><span class="text-sm max-sm:text-xs font-medium me-2 px-2.5 py-0.5 rounded-sm bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-300"><span>medium</span></span></td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line ">Rancher RKE2 must prevent nonprivileged users from executing privileged functions to include disabling, circumventing, or altering implemented security safeguards/countermeasures.</td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line max-lg:hidden">Admission controllers intercept requests to the Kubernetes API before an object is instantiated. Enabling the admissions webhook allows for Kubernetes to apply policies against objects that are to be created, read, updated or deleted.

Admissions controllers can be used for:
- Prevent pod’s ability to run privileged containers
- Prevent pod’s ability to use privileged escalation
- Controlling pod’s access to volume types
- Controlling pod’s access to host file system
- Controlling pod’s usage of host networking objects and configuration

Satisfies: SRG-APP-000340-CTR-000770, SRG-APP-000342-CTR-000775</td></tr><tr class="odd:bg-white odd:dark:bg-zinc-900 even:bg-zinc-50 even:dark:bg-zinc-800 border-b dark:border-zinc-700 border-zinc-200"><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line "><a class="flex flex-col whitespace-nowrap" href="/stigs/RGS_RKE2_STIG/groups/V-254572">V-254572</a></td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line "><span class="text-sm max-sm:text-xs font-medium me-2 px-2.5 py-0.5 rounded-sm bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-300"><span>medium</span></span></td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line ">Rancher RKE2 must prohibit the installation of patches, updates, and instantiation of container images without explicit privileged status.</td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line max-lg:hidden">Controlling access to those users and roles responsible for patching and updating RKE2 reduces the risk of untested or potentially malicious software from being installed within the platform. This access may be separate from the access required to install container images into the registry and those access requirements required to instantiate an image into a service. Explicit privileges (escalated or administrative privileges) provide the regular user with explicit capabilities and control that exceeds the rights of a regular user.

Kubernetes uses the API Server to control communication to the other services that makeup Kubernetes. The use of authorizations and not the default of &quot;AlwaysAllow&quot; enables the Kubernetes functions control to only the groups that need them.

To control access, the API server must have one of the following options set for the authorization mode:
    --authorization-mode=ABAC Attribute-Based Access Control (ABAC) mode allows a user to configure policies using local files.
    --authorization-mode=RBAC Role-based access control (RBAC) mode allows a user to create and store policies using the Kubernetes API.
    --authorization-mode=Webhook
WebHook is an HTTP callback mode that allows a user to manage authorization using a remote REST endpoint.
    --authorization-mode=Node 
Node authorization is a special-purpose authorization mode that specifically authorizes API requests made by kubelets.
    --authorization-mode=AlwaysDeny 
This flag blocks all requests. Use this flag only for testing.

Satisfies: SRG-APP-000378-CTR-000880, SRG-APP-000378-CTR-000885</td></tr><tr class="odd:bg-white odd:dark:bg-zinc-900 even:bg-zinc-50 even:dark:bg-zinc-800 border-b dark:border-zinc-700 border-zinc-200"><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line "><a class="flex flex-col whitespace-nowrap" href="/stigs/RGS_RKE2_STIG/groups/V-254574">V-254574</a></td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line "><span class="text-sm max-sm:text-xs font-medium me-2 px-2.5 py-0.5 rounded-sm bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-300"><span>medium</span></span></td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line ">Rancher RKE2 must remove old components after updated versions have been installed.</td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line max-lg:hidden">Previous versions of Rancher RKE2 components that are not removed after updates have been installed may be exploited by adversaries by causing older components to execute which contain vulnerabilities. When these components are deleted, the likelihood of this happening is removed.</td></tr><tr class="odd:bg-white odd:dark:bg-zinc-900 even:bg-zinc-50 even:dark:bg-zinc-800 border-b dark:border-zinc-700 border-zinc-200"><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line "><a class="flex flex-col whitespace-nowrap" href="/stigs/RGS_RKE2_STIG/groups/V-254575">V-254575</a></td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line "><span class="text-sm max-sm:text-xs font-medium me-2 px-2.5 py-0.5 rounded-sm bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-300"><span>medium</span></span></td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line ">Rancher RKE2 registry must contain the latest images with most recent updates and execute within Rancher RKE2 runtime as authorized by IAVM, CTOs, DTMs, and STIGs.</td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line max-lg:hidden">Software supporting RKE2, images in the registry must stay up to date with the latest patches, service packs, and hot fixes. Not updating RKE2 and container images will expose the organization to vulnerabilities.

Flaws discovered during security assessments, continuous monitoring, incident response activities, or information system error handling must also be addressed expeditiously.

Organization-defined time periods for updating security-relevant container platform components may vary based on a variety of factors including, for example, the security category of the information system or the criticality of the update (i.e., severity of the vulnerability related to the discovered flaw).

This requirement will apply to software patch management solutions used to install patches across the enclave and to applications themselves that are not part of that patch management solution. For example, many browsers today provide the capability to install their own patch software. Patch criticality, as well as system criticality will vary. Therefore, the tactical situations regarding the patch management process will also vary. This means that the time period utilized must be a configurable parameter. Time frames for application of security-relevant software updates may be dependent upon the Information Assurance Vulnerability Management (IAVM) process.

RKE2 components will be configured to check for and install security-relevant software updates within an identified time period from the availability of the update. RKE2 registry will ensure the images are current. The specific time period will be defined by an authoritative source (e.g., IAVM, CTOs, DTMs, and STIGs).</td></tr><tr class="odd:bg-white odd:dark:bg-zinc-900 even:bg-zinc-50 even:dark:bg-zinc-800 border-b dark:border-zinc-700 border-zinc-200"><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line "><a class="flex flex-col whitespace-nowrap" href="/stigs/RGS_RKE2_STIG/groups/V-268321">V-268321</a></td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line "><span class="text-sm max-sm:text-xs font-medium me-2 px-2.5 py-0.5 rounded-sm bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-300"><span>medium</span></span></td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line ">Rancher RKE2 must be built from verified packages.</td><td scope="row" class="px-6 py-4 text-zinc-900 dark:text-zinc-300 whitespace-pre-line max-lg:hidden">Only RKE2 images that have been properly signed by Rancher Government&#x27;s authorized key will be deployed to ensure the cluster&#x27;s security and compliance with organizational policies.</td></tr></tbody></table></form></div></section><!--/$--></main><footer class="row-start-3 flex gap-6 flex-wrap items-center justify-center"></footer></div><footer class="bg-white dark:bg-zinc-900 border-t border-zinc-200 dark:border-zinc-700"><div class="w-full max-w-screen-xl mx-auto p-4 md:py-8"><span class="block text-sm text-zinc-500 sm:text-center"><div class="flex flex-row items-center justify-center">Not affiliated with DISA.<a href="https://github.com/nealfennimore/stig" class="block text-sm text-zinc-500 sm:text-center" tabindex="100"><svg class="w-5 h-5 mx-4" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 .333A9.911 9.911 0 0 0 6.866 19.65c.5.092.678-.215.678-.477 0-.237-.01-1.017-.014-1.845-2.757.6-3.338-1.169-3.338-1.169a2.627 2.627 0 0 0-1.1-1.451c-.9-.615.07-.6.07-.6a2.084 2.084 0 0 1 1.518 1.021 2.11 2.11 0 0 0 2.884.823c.044-.503.268-.973.63-1.325-2.2-.25-4.516-1.1-4.516-4.9A3.832 3.832 0 0 1 4.7 7.068a3.56 3.56 0 0 1 .095-2.623s.832-.266 2.726 1.016a9.409 9.409 0 0 1 4.962 0c1.89-1.282 2.717-1.016 2.717-1.016.366.83.402 1.768.1 2.623a3.827 3.827 0 0 1 1.02 2.659c0 3.807-2.319 4.644-4.525 4.889a2.366 2.366 0 0 1 .673 1.834c0 1.326-.012 2.394-.012 2.72 0 .263.18.572.681.475A9.911 9.911 0 0 0 10 .333Z" clip-rule="evenodd"></path></svg></a></div></span><span class="block text-sm text-zinc-500 sm:text-center flex flex-row items-center justify-center">© 2025<!-- --> <a href="https://neal.codes" class="hover:underline mx-1" tabindex="70">neal.codes</a>All Rights Reserved.</span></div></footer><!--$--><!--/$--><!--$--><!--/$--><script src="/_next/static/chunks/webpack-9f9d947a63484a6e.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[7555,[],\"\"]\n3:I[1295,[],\"\"]\n5:I[9665,[],\"MetadataBoundary\"]\n7:I[9665,[],\"OutletBoundary\"]\na:I[4911,[],\"AsyncMetadataOutlet\"]\nc:I[9665,[],\"ViewportBoundary\"]\ne:I[6614,[],\"\"]\n:HL[\"/_next/static/media/4473ecc91f70f139-s.p.woff\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff\"}]\n:HL[\"/_next/static/media/463dafcda517f24f-s.p.woff\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff\"}]\n:HL[\"/_next/static/css/704a2760ecb090f6.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"qmpmF3co9rdMhukFRnYyE\",\"p\":\"\",\"c\":[\"\",\"stigs\",\"RGS_RKE2_STIG\",\"Public\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"stigs\",{\"children\":[[\"stig_id\",\"RGS_RKE2_STIG\",\"d\"],{\"children\":[[\"classification\",\"Public\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/704a2760ecb090f6.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[[\"$\",\"head\",null,{\"children\":[\"$\",\"script\",null,{\"src\":\"/service-worker.js\"}]}],[\"$\",\"body\",null,{\"className\":\"__variable_1e4310 __variable_c3aa02 antialiased dark:bg-zinc-900 dark:text-zinc-100\",\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]]}]]}],{\"children\":[\"stigs\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"stig_id\",\"RGS_RKE2_STIG\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"classification\",\"Public\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$L4\",[\"$\",\"$L5\",null,{\"children\":\"$L6\"}],null,[\"$\",\"$L7\",null,{\"children\":[\"$L8\",\"$L9\",[\"$\",\"$La\",null,{\"promise\":\"$@b\"}]]}]]}],{},null,false]},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$1\",\"2ipjIrnqofHnhWnZVjYOZ\",{\"children\":[[\"$\",\"$Lc\",null,{\"children\":\"$Ld\"}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]]}],null]}],false]],\"m\":\"$undefined\",\"G\":[\"$e\",\"$undefined\"],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"f:\"$Sreact.suspense\"\n10:I[4911,[],\"AsyncMetadata\"]\n12:I[1214,[\"167\",\"static/chunks/167-1b0faf1b73f1083f.js\",\"967\",\"static/chunks/967-21d88758be072729.js\",\"92\",\"static/chunks/app/stigs/%5Bstig_id%5D/%5Bclassification%5D/page-f5a2fd719d00911b.js\"],\"default\"]\n13:I[2272,[\"167\",\"static/chunks/167-1b0faf1b73f1083f.js\",\"967\",\"static/chunks/967-21d88758be072729.js\",\"92\",\"static/chunks/app/stigs/%5Bstig_id%5D/%5Bclassification%5D/page-f5a2fd719d00911b.js\"],\"default\"]\n14:I[2350,[\"167\",\"static/chunks/167-1b0faf1b73f1083f.js\",\"967\",\"static/chunks/967-21d88758be072729.js\",\"92\",\"static/chunks/app/stigs/%5Bstig_id%5D/%5Bclassification%5D/page-f5a2fd719d00911b.js\"],\"Navigation\"]\n15:I[6261,[\"167\",\"static/chunks/167-1b0faf1b73f1083f.js\",\"967\",\"static/chunks/967-21d88758be072729.js\",\"92\",\"static/chunks/app/stigs/%5Bstig_id%5D/%5Bclassification%5D/page-f5a2fd719d00911b.js\"],\"StigView\"]\n6:[\"$\",\"$f\",null,{\"fallback\":null,\"children\":[\"$\",\"$L10\",null,{\"promise\":\"$@11\"}]}]\n"])</script><script>self.__next_f.push([1,"4:[\"$\",\"$L12\",null,{\"children\":[\"$\",\"$L13\",null,{\"stigId\":\"RGS_RKE2_STIG\",\"children\":[[\"$\",\"$L14\",null,{}],[\"$\",\"div\",null,{\"className\":\"grid grid-rows-[20px_1fr_20px] items-center justify-items-center p-8 md:p-6 max-sm:p-2 pb-20 gap-16 font-[family-name:var(--font-geist-sans)]\",\"children\":[[\"$\",\"main\",null,{\"className\":\"flex flex-col gap-8 row-start-2 items-center sm:items-start max-w-screen-xl\",\"children\":[\"$\",\"$L15\",null,{\"stigId\":\"RGS_RKE2_STIG\",\"classification\":\"Public\"}]}],[\"$\",\"footer\",null,{\"className\":\"row-start-3 flex gap-6 flex-wrap items-center justify-center\"}]]}],[\"$\",\"footer\",null,{\"className\":\"bg-white dark:bg-zinc-900 border-t border-zinc-200 dark:border-zinc-700\",\"children\":[\"$\",\"div\",null,{\"className\":\"w-full max-w-screen-xl mx-auto p-4 md:py-8\",\"children\":[[\"$\",\"span\",null,{\"className\":\"block text-sm text-zinc-500 sm:text-center\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex flex-row items-center justify-center\",\"children\":[\"Not affiliated with DISA.\",[\"$\",\"a\",null,{\"href\":\"https://github.com/nealfennimore/stig\",\"className\":\"block text-sm text-zinc-500 sm:text-center\",\"tabIndex\":100,\"children\":[\"$\",\"svg\",null,{\"className\":\"w-5 h-5 mx-4\",\"aria-hidden\":\"true\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"children\":[\"$\",\"path\",null,{\"fillRule\":\"evenodd\",\"d\":\"M10 .333A9.911 9.911 0 0 0 6.866 19.65c.5.092.678-.215.678-.477 0-.237-.01-1.017-.014-1.845-2.757.6-3.338-1.169-3.338-1.169a2.627 2.627 0 0 0-1.1-1.451c-.9-.615.07-.6.07-.6a2.084 2.084 0 0 1 1.518 1.021 2.11 2.11 0 0 0 2.884.823c.044-.503.268-.973.63-1.325-2.2-.25-4.516-1.1-4.516-4.9A3.832 3.832 0 0 1 4.7 7.068a3.56 3.56 0 0 1 .095-2.623s.832-.266 2.726 1.016a9.409 9.409 0 0 1 4.962 0c1.89-1.282 2.717-1.016 2.717-1.016.366.83.402 1.768.1 2.623a3.827 3.827 0 0 1 1.02 2.659c0 3.807-2.319 4.644-4.525 4.889a2.366 2.366 0 0 1 .673 1.834c0 1.326-.012 2.394-.012 2.72 0 .263.18.572.681.475A9.911 9.911 0 0 0 10 .333Z\",\"clipRule\":\"evenodd\"}]}]}]]}]}],[\"$\",\"span\",null,{\"className\":\"block text-sm text-zinc-500 sm:text-center flex flex-row items-center justify-center\",\"children\":[\"© 2025\",\" \",[\"$\",\"a\",null,{\"href\":\"https://neal.codes\",\"className\":\"hover:underline mx-1\",\"tabIndex\":70,\"children\":\"neal.codes\"}],\"All Rights Reserved.\"]}]]}]}]]}]}]\n"])</script><script>self.__next_f.push([1,"9:null\n"])</script><script>self.__next_f.push([1,"d:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n8:null\n"])</script><script>self.__next_f.push([1,"11:{\"metadata\":[[\"$\",\"title\",\"0\",{\"children\":\"STIGs | Rancher Government Solutions RKE2 Security Technical Implementation Guide | Public\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DOD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents. Comments or proposed revisions to this document should be sent via email to the following address: disa.stig_spt@mail.mil.\"}],[\"$\",\"meta\",\"2\",{\"name\":\"application-name\",\"content\":\"STIGUI\"}],[\"$\",\"meta\",\"3\",{\"name\":\"keywords\",\"content\":\"Release: 3 Benchmark Date: 30 Jan 2025,3.5,1.10.0,Public\"}],[\"$\",\"meta\",\"4\",{\"name\":\"creator\",\"content\":\"DISA\"}],[\"$\",\"meta\",\"5\",{\"name\":\"publisher\",\"content\":\"DISA\"}],[\"$\",\"meta\",\"6\",{\"property\":\"og:title\",\"content\":\"STIGs | Rancher Government Solutions RKE2 Security Technical Implementation Guide | Public\"}],[\"$\",\"meta\",\"7\",{\"property\":\"og:description\",\"content\":\"This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DOD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents. Comments or proposed revisions to this document should be sent via email to the following address: disa.stig_spt@mail.mil.\"}],[\"$\",\"meta\",\"8\",{\"property\":\"og:url\",\"content\":\"https://stig.neal.codes/stigs/RGS_RKE2_STIG\"}],[\"$\",\"meta\",\"9\",{\"property\":\"og:site_name\",\"content\":\"STIGUI\"}],[\"$\",\"meta\",\"10\",{\"property\":\"og:type\",\"content\":\"article\"}],[\"$\",\"meta\",\"11\",{\"property\":\"article:published_time\",\"content\":\"2024-12-20T00:00:00.000Z\"}],[\"$\",\"meta\",\"12\",{\"property\":\"article:author\",\"content\":\"DISA\"}],[\"$\",\"meta\",\"13\",{\"property\":\"article:tag\",\"content\":\"Release: 3 Benchmark Date: 30 Jan 2025\"}],[\"$\",\"meta\",\"14\",{\"property\":\"article:tag\",\"content\":\"3.5\"}],[\"$\",\"meta\",\"15\",{\"property\":\"article:tag\",\"content\":\"1.10.0\"}],[\"$\",\"meta\",\"16\",{\"property\":\"article:tag\",\"content\":\"Public\"}],[\"$\",\"meta\",\"17\",{\"name\":\"twitter:card\",\"content\":\"summary\"}],[\"$\",\"meta\",\"18\",{\"name\":\"twitter:title\",\"content\":\"STIGs | Rancher Government Solutions RKE2 Security Technical Implementation Guide | Public\"}],[\"$\",\"meta\",\"19\",{\"name\":\"twitter:description\",\"content\":\"This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DOD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents. Comments or proposed revisions to this document should be sent via email to the following address: disa.stig_spt@mail.mil.\"}],[\"$\",\"link\",\"20\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"16x16\"}]],\"error\":null,\"digest\":\"$undefined\"}\n"])</script><script>self.__next_f.push([1,"b:{\"metadata\":\"$11:metadata\",\"error\":null,\"digest\":\"$undefined\"}\n"])</script></body></html>