(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{152:(e,t,s)=>{"use strict";s.d(t,{Stigs:()=>d});var i=s(5155),r=s(7597),l=s(4125),n=s(6874),a=s.n(n),u=s(2115);let c=[r.AG,r.AG,r.AG],o=[r.kv,null,null],d=()=>{var e;let t=(0,l.u2)(),s=(0,u.useRef)(null);if(!(null==(e=t.elements)?void 0:e.length))return null;let n=(0,u.useMemo)(()=>[{text:"STIG",filterable:!0},{text:"Version",filterable:!1,className:"text-center"},{text:"Date",filterable:!1,className:"max-md:hidden"}],[]),d=(0,u.useMemo)(()=>t.elements.map(e=>({values:[e.title,e.version,e.date],columns:[(0,i.jsx)(a(),{className:"flex flex-col",href:"/stigs/".concat(e.id),children:e.title}),e.version,e.date],classNames:[null,"text-center","max-md:hidden"]})),[t.elements]);return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)("section",{className:"w-full flex flex-col",children:(0,i.jsx)("div",{className:"relative overflow-x-auto shadow-md sm:rounded-lg",children:(0,i.jsx)("form",{ref:s,onSubmit:e=>e.preventDefault(),children:(0,i.jsx)(r.XI,{sorters:c,filters:o,tableHeaders:n,tableBody:d,initialOrders:[r.pH.ASC,r.pH.NONE,r.pH.NONE],formRef:s})})})})})}},1477:(e,t,s)=>{Promise.resolve().then(s.bind(s,2350)),Promise.resolve().then(s.bind(s,152)),Promise.resolve().then(s.bind(s,4125)),Promise.resolve().then(s.bind(s,5383))},5383:(e,t,s)=>{"use strict";let i;s.r(t),s.d(t,{IDB:()=>f,clear:()=>w,get:()=>g,getAll:()=>h,getDB:()=>u,getIndex:()=>d,getStore:()=>o,put:()=>m,version:()=>r});let r=1;var l,n,a=function(e){return e.CHECKLISTS="checklists",e.STIGS="stigs",e.RULES="rules",e.CHECKLIST_STIGS="checklist_stigs",e}(a||{});{let e=null==(n=window)||null==(l=n.indexedDB)?void 0:l.open("stigs",r);i=new Promise((t,s)=>{e.onerror=e=>{console.error("Can't use IndexDB"),s(e)},e.onsuccess=e=>{var s;t(null==(s=e.target)?void 0:s.result)},e.onupgradeneeded=function(e){var t;let s=null==(t=e.target)?void 0:t.result,i=s.createObjectStore("checklists",{keyPath:"id"});i.createIndex("title","title",{unique:!1}),i.createIndex("active","active",{unique:!1}),i.createIndex("mode","mode",{unique:!1});let r=s.createObjectStore("stigs",{keyPath:"uuid"});r.createIndex("stig_id","stig_id",{unique:!1}),r.createIndex("stig_name","stig_name",{unique:!1});let l=s.createObjectStore("rules",{keyPath:"uuid"});l.createIndex("group_id","group_id",{unique:!1}),l.createIndex("rule_id","rule_id",{unique:!1}),l.createIndex("stig_uuid","stig_uuid",{unique:!1}),l.createIndex("status","status",{unique:!1}),l.createIndex("severity","severity",{unique:!1});let n=s.createObjectStore("checklist_stigs",{keyPath:"id",autoIncrement:!0});n.createIndex("checklist_id","checklist_id",{unique:!1}),n.createIndex("stig_uuid","stig_uuid",{unique:!1}),n.createIndex("checklist_stig",["checklist_id","stig_uuid"],{unique:!0})}})}let u=function(){return i||Promise.reject("Can't use IndexDB")};var c=function(e){return e.READONLY="readonly",e.READWRITE="readwrite",e}(c||{});let o=async(e,t)=>(await u()).transaction(e,t).objectStore(e),d=async(e,t,s)=>(await o(e,t)).index(s),h=(e,t)=>async function(){let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1?arguments[1]:void 0,r=await o(e,"readonly");t&&(r=r.index(t));let l=r.getAll(s,i);return new Promise((e,t)=>{l.onsuccess=()=>{e(l.result)},l.onerror=()=>{t()}})},g=(e,t)=>async s=>{let i=await o(e,"readonly");t&&(i=i.index(t));let r=i.get(s);return new Promise((e,t)=>{r.onsuccess=()=>{e(r.result)},r.onerror=()=>{t()}})},m=e=>async t=>{let s=await o(e,"readwrite");return new Promise((e,i)=>{let r=s.put(t);r.onsuccess=()=>{e(r.result)},r.onerror=()=>{i()}})},w=e=>async()=>{let t=await o(e,"readwrite");return new Promise((e,s)=>{let i=t.clear();i.onsuccess=()=>{e(!0)},i.onerror=()=>{s(!1)}})};class x{constructor(e,t){this.getAll=h(e,t),this.get=g(e,t)}}class v{constructor(e){this.table=e,this.getAll=h(e),this.get=g(e),this.put=m(e),this.clear=w(e),this.store=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"readonly";return o(e,t)}}}class f{static async exportChecklist(e){try{let t=await f.checklists.get(e);if(!t)throw Error("Checklist not found");let s=(await new x(f.checklistStigs.table,"checklist_id").getAll(e)).map(e=>e.stig_uuid),i=await Promise.all(s.map(e=>f.stigs.get(e))),r=new x(f.rules.table,"stig_uuid"),l=await s.reduce(async(e,t)=>{let s=await e,i=await r.getAll(t);return s[t]=i,s},Promise.resolve({}));return{...t,stigs:i.map(e=>({...e,rules:l[e.uuid],size:l[e.uuid].length}))}}catch(e){throw console.error("Error exporting checklist:",e),e}}static async importChecklist(e){try{let{stigs:t,...s}=e;for(let e of(await f.checklists.put(s),t)){let{rules:t,...i}=e;for(let e of(await f.stigs.put(i),await f.checklistStigs.put({checklist_id:s.id,stig_uuid:i.uuid}),t))e.uuid&&await f.rules.put(e)}return!0}catch(e){return console.error("Error importing checklist:",e),!1}}}f.checklists=new v("checklists"),f.stigs=new v("stigs"),f.rules=new v("rules"),f.checklistStigs=new v("checklist_stigs"),f.version=r,window.db=f}},e=>{var t=t=>e(e.s=t);e.O(0,[167,548,441,684,358],()=>t(1477)),_N_E=e.O()}]);