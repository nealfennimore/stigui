(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[176],{2176:(e,t,r)=>{Promise.resolve().then(r.bind(r,2350)),Promise.resolve().then(r.bind(r,6261)),Promise.resolve().then(r.bind(r,4125)),Promise.resolve().then(r.bind(r,2272))},2272:(e,t,r)=>{"use strict";r.d(t,{KR:()=>c,default:()=>d});var s=r(5155),i=r(2072),l=r(2115);let n=(0,l.createContext)(null);function a(e){let{children:t,value:r}=e;return(0,s.jsx)(n.Provider,{value:r,children:t})}function c(){return(0,l.use)(function(){let e=(0,l.useContext)(n);if(!e)throw Error("useStigContext must be used within a StigProvider");return e}())}function d(e){let{stigId:t,children:r}=e,l=i.Ay.read("".concat(t,".json"));return(0,s.jsx)(a,{value:l,children:r})}},3522:(e,t,r)=>{"use strict";r.d(t,{B:()=>a});var s=r(5155),i=r(4125),l=r(6874),n=r.n(l);let a=e=>{let{stigId:t,group:r,editor:l}=e,a=(0,i.u2)(),c=l?[{href:"/editor",text:"Checklists"}]:[{href:"/stigs",text:"STIGs"}];if(t){let e=a.byId(t);c.push({href:"/stigs/".concat(t),text:"".concat(e.title)})}return r&&c.push({href:"/stigs/".concat(t,"/groups/").concat(r.id),text:"".concat(r.id)}),(0,s.jsx)("aside",{className:"flex flex-row items-center justify-start w-full",children:c.map((e,t)=>(0,s.jsxs)("span",{children:[(0,s.jsx)(n(),{className:"text-sm text-zinc-400",href:e.href,"aria-disabled":e.disabled,tabIndex:60,children:e.text}),t<c.length-1&&(0,s.jsxs)("span",{className:"text-sm mx-2 text-zinc-300",children:[" ",">"," "]})]},t))})}},5383:(e,t,r)=>{"use strict";let s;r.r(t),r.d(t,{IDB:()=>p,clear:()=>g,get:()=>h,getAll:()=>x,getDB:()=>c,getIndex:()=>u,getStore:()=>o,put:()=>m,version:()=>i});let i=1;var l,n,a=function(e){return e.CHECKLISTS="checklists",e.STIGS="stigs",e.RULES="rules",e.CHECKLIST_STIGS="checklist_stigs",e}(a||{});{let e=null==(n=window)||null==(l=n.indexedDB)?void 0:l.open("stigs",i);s=new Promise((t,r)=>{e.onerror=e=>{console.error("Can't use IndexDB"),r(e)},e.onsuccess=e=>{var r;t(null==(r=e.target)?void 0:r.result)},e.onupgradeneeded=function(e){var t;let r=null==(t=e.target)?void 0:t.result,s=r.createObjectStore("checklists",{keyPath:"id"});s.createIndex("title","title",{unique:!1}),s.createIndex("active","active",{unique:!1}),s.createIndex("mode","mode",{unique:!1});let i=r.createObjectStore("stigs",{keyPath:"uuid"});i.createIndex("stig_id","stig_id",{unique:!1}),i.createIndex("stig_name","stig_name",{unique:!1});let l=r.createObjectStore("rules",{keyPath:"uuid"});l.createIndex("group_id","group_id",{unique:!1}),l.createIndex("rule_id","rule_id",{unique:!1}),l.createIndex("stig_uuid","stig_uuid",{unique:!1}),l.createIndex("status","status",{unique:!1}),l.createIndex("severity","severity",{unique:!1});let n=r.createObjectStore("checklist_stigs",{keyPath:"id",autoIncrement:!0});n.createIndex("checklist_id","checklist_id",{unique:!1}),n.createIndex("stig_uuid","stig_uuid",{unique:!1}),n.createIndex("checklist_stig",["checklist_id","stig_uuid"],{unique:!0})}})}let c=function(){return s||Promise.reject("Can't use IndexDB")};var d=function(e){return e.READONLY="readonly",e.READWRITE="readwrite",e}(d||{});let o=async(e,t)=>(await c()).transaction(e,t).objectStore(e),u=async(e,t,r)=>(await o(e,t)).index(r),x=(e,t)=>async function(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,s=arguments.length>1?arguments[1]:void 0,i=await o(e,"readonly");t&&(i=i.index(t));let l=i.getAll(r,s);return new Promise((e,t)=>{l.onsuccess=()=>{e(l.result)},l.onerror=()=>{t()}})},h=(e,t)=>async r=>{let s=await o(e,"readonly");t&&(s=s.index(t));let i=s.get(r);return new Promise((e,t)=>{i.onsuccess=()=>{e(i.result)},i.onerror=()=>{t()}})},m=e=>async t=>{let r=await o(e,"readwrite");return new Promise((e,s)=>{let i=r.put(t);i.onsuccess=()=>{e(i.result)},i.onerror=()=>{s()}})},g=e=>async()=>{let t=await o(e,"readwrite");return new Promise((e,r)=>{let s=t.clear();s.onsuccess=()=>{e(!0)},s.onerror=()=>{r(!1)}})};class b{constructor(e,t){this.getAll=x(e,t),this.get=h(e,t)}}class f{constructor(e){this.table=e,this.getAll=x(e),this.get=h(e),this.put=m(e),this.clear=g(e),this.store=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"readonly";return o(e,t)}}}class p{static async exportChecklist(e){try{let t=await p.checklists.get(e);if(!t)throw Error("Checklist not found");let r=(await new b(p.checklistStigs.table,"checklist_id").getAll(e)).map(e=>e.stig_uuid),s=await Promise.all(r.map(e=>p.stigs.get(e))),i=new b(p.rules.table,"stig_uuid"),l=await r.reduce(async(e,t)=>{let r=await e,s=await i.getAll(t);return r[t]=s,r},Promise.resolve({}));return{...t,stigs:s.map(e=>({...e,rules:l[e.uuid],size:l[e.uuid].length}))}}catch(e){throw console.error("Error exporting checklist:",e),e}}static async importChecklist(e){try{let{stigs:t,...r}=e;for(let e of(await p.checklists.put(r),t)){let{rules:t,...s}=e;for(let e of(await p.stigs.put(s),await p.checklistStigs.put({checklist_id:r.id,stig_uuid:s.uuid}),t))e.uuid&&await p.rules.put(e)}return!0}catch(e){return console.error("Error importing checklist:",e),!1}}}p.checklists=new f("checklists"),p.stigs=new f("stigs"),p.rules=new f("rules"),p.checklistStigs=new f("checklist_stigs"),p.version=i,window.db=p},5695:(e,t,r)=>{"use strict";var s=r(8999);r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}}),r.o(s,"useSearchParams")&&r.d(t,{useSearchParams:function(){return s.useSearchParams}})},6261:(e,t,r)=>{"use strict";r.d(t,{StigView:()=>z});var s=r(5155),i=r(3220),l=r(2072),n=r(6792),a=r(2272),c=r(5383),d=r(4754),o=r(6874),u=r.n(o),x=r(5695),h=r(2115),m=r(3522),g=r(8473),b=r(7969),f=r(7597);let p=[f.AG,b.Np,f.AG,null],w=[null,null,f.kv,f.kv],v=[{text:"Group ID"},{text:"Severity",className:"text-center"},{text:"Title"},{text:"Description",className:"max-lg:hidden"}],k=e=>{let t=new Blob([["Group ID,Severity,Title,Description,Rule ID,Fix ID,Fix Text,Check ID,Check Text",...e.groups.map(e=>[e.id,e.rule.severity,'"'.concat(e.rule.title.replaceAll('"',"'"),'"'),'"'.concat(e.rule.description.replaceAll('"',"'"),'"'),e.rule.id,e.rule.fix,'"'.concat(e.rule.fixText.replaceAll('"',"'"),'"'),e.rule.checkId,'"'.concat(e.rule.check.replaceAll('"',"'"),'"')].join(","))].join("\n")],{type:"text/csv"}),r=URL.createObjectURL(t);(0,d.R)(r,"".concat(e.id,".csv")),URL.revokeObjectURL(r)},j=async(e,t,r)=>{let s=i.A.fromStig(e.stig,Object.values(e.rawProfilesByClassification[t]).flat());await c.IDB.importChecklist(s),r.push("/editor?id=".concat(s.id))},y=e=>{let{classfication:t,selectedClassfication:r,setClassficationLevel:i,index:l,stigId:n}=e,a=t===r?"dark:bg-zinc-500 bg-zinc-200":"dark:bg-zinc-800 bg-white";return(0,s.jsx)(u(),{href:"/stigs/".concat(n,"/").concat(t),className:"px-4 py-2 text-sm font-medium text-zinc-900 border-zinc-200 hover:bg-zinc-100 hover:text-blue-700 focus:z-10 focus:ring-2 focus:ring-blue-700 focus:text-blue-700  dark:border-zinc-700 dark:text-white dark:hover:text-white dark:hover:bg-zinc-700 dark:focus:ring-blue-500 dark:focus:text-white ".concat(a," ").concat(0===l?"rounded-s-lg border":"border-t border-b"," ").concat(2===l?"rounded-e-lg border":"border-t border-b"),onClick:()=>i(t),children:t})},z=e=>{let{stigId:t,classification:r}=e,i=(0,a.KR)(),c=(0,x.useRouter)(),[o,z]=(0,h.useState)(new Set),[N,I]=(0,h.useState)(r||l.Jq.Public),[S,C]=(0,h.useState)(null),_=(0,h.useRef)(null);(0,h.useEffect)(()=>{var e;let t=()=>{C(null)};return null==(e=document.querySelector("body"))||e.addEventListener("click",t),()=>{var e;null==(e=document.querySelector("body"))||e.removeEventListener("click",t)}},[S]);let A=(0,h.useMemo)(()=>i.profilesByClassification,[i]),P=(0,h.useMemo)(()=>i.groupsByProfiles(Object.values(A[N]).flat()),[i,A]),D=(0,h.useMemo)(()=>{let e={};return Object.values(P).forEach(t=>{e[t.rule.severity]||(e[t.rule.severity]=0),e[t.rule.severity]++}),Object.entries(e).sort((e,t)=>{let[r]=e,[s]=t;return(0,b.Np)(s,r)})},[P]),R=(0,h.useMemo)(()=>{var e;return null!==S&&(null==(e=Object.values(P))?void 0:e[S])},[P,S]),E=(0,h.useMemo)(()=>Object.values(P).filter(e=>0===o.size||o.has(e.rule.severity)).map((e,r)=>({onClick:()=>C(r),values:[e.id,e.rule.severity,e.rule.title,e.rule.description],columns:[(0,s.jsx)(u(),{className:"flex flex-col whitespace-nowrap",href:"/stigs/".concat(t,"/groups/").concat(e.id),children:e.id}),(0,s.jsx)(b.Pt,{severity:e.rule.severity}),e.rule.title,e.rule.description],classNames:[null,null,null,"max-lg:hidden"]})),[P,t,o,C]),L=(0,h.useMemo)(()=>Object.values(l.Jq),[]),B=null!==S&&S>-1&&!!R;return(0,s.jsxs)(h.Suspense,{fallback:(0,s.jsx)("div",{children:"Loading..."}),children:[(0,s.jsx)(m.B,{stigId:t}),(0,s.jsx)(n.B,{isOpen:B,onClick:()=>C(null),headerText:B&&(0,s.jsx)(u(),{href:"/stigs/".concat(t,"/groups/").concat(R.id),children:R.id}),children:B&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(g.G,{group:R}),(0,s.jsx)("div",{className:"text-zinc-600 dark:text-zinc-500 flex flex-row justify-start items-center",children:(0,s.jsxs)(u(),{className:"text-sm ml-4",href:"/stigs/".concat(t,"/groups/").concat(R.id),children:["Go to ",R.id]})})]})}),(0,s.jsx)("h1",{className:"text-3xl mt-6",children:i.title}),(0,s.jsx)("p",{className:"text-base discussion",children:i.description}),(0,s.jsxs)("section",{className:"text-zinc-600 dark:text-zinc-500 text-xs w-full flex justify-between items-center",children:[(0,s.jsx)("aside",{className:"inline-flex rounded-md shadow-xs",role:"group",children:L.map((e,r)=>(0,s.jsx)(y,{stigId:t,classfication:e,selectedClassfication:N,setClassficationLevel:I,index:r},e))}),(0,s.jsxs)("div",{className:"text-zinc-600 dark:text-zinc-500 text-xs flex flex-col align-end text-end",children:[(0,s.jsxs)("span",{children:["Date: ",i.date]}),(0,s.jsxs)("span",{children:["Version: ",i.version]})]})]}),(0,s.jsxs)("section",{className:"w-full flex justify-between items-center",children:[(0,s.jsx)("div",{children:D.map(e=>{let[t,r]=e;return(0,s.jsx)(b.Pt,{severity:t,count:r,Element:"button",selected:o.has(t),onClick:()=>{let e=new Set(o);e.has(t)?e.delete(t):e.add(t),z(e)}},t)})}),(0,s.jsxs)("div",{className:"text-zinc-600 dark:text-zinc-500 text-xs flex",children:[(0,s.jsx)("button",{onClick:()=>(0,d.R)("/data/stigs/schema/".concat(i.id,".xml"),"".concat(i.id,".xml")),className:"text-zinc-600 dark:text-zinc-500 text-xs flex flex-col mr-4",children:"XML ⬇️"}),(0,s.jsx)("button",{onClick:()=>(0,d.R)("/data/stigs/schema/".concat(i.id,".json"),"".concat(i.id,".json")),className:"text-zinc-600 dark:text-zinc-500 text-xs flex flex-col mr-4",children:"JSON ⬇️"}),(0,s.jsx)("button",{onClick:()=>k(i),className:"text-zinc-600 dark:text-zinc-500 text-xs flex flex-col mr-4",children:"CSV ⬇️"}),(0,s.jsx)("button",{onClick:()=>j(i,N,c),className:"text-zinc-600 dark:text-zinc-500 text-xs flex flex-col",children:"Edit \uD83D\uDCDD"})]})]}),(0,s.jsx)("section",{className:"w-full flex flex-col",children:(0,s.jsx)("div",{className:"relative overflow-x-auto shadow-md sm:rounded-lg",children:(0,s.jsx)("form",{ref:_,onSubmit:e=>e.preventDefault(),children:(0,s.jsx)(f.XI,{sorters:p,filters:w,tableHeaders:v,tableBody:E,initialOrders:[f.pH.ASC,f.pH.DESC,f.pH.NONE],formRef:_})})})})]})}},6792:(e,t,r)=>{"use strict";r.d(t,{B:()=>i});var s=r(5155);r(2115);let i=e=>{let{isOpen:t=!0,children:r,onClick:i,headerText:l=""}=e;return(0,s.jsxs)("aside",{id:"drawer-navigation",className:"fixed top-0 right-0 z-40 w-fit max-w-5xl h-screen p-4 overflow-y-auto transition-transform bg-white dark:bg-zinc-900 sm:max-w-screen border-l border-zinc-300 dark:border-zinc-700 ".concat(t?"transform-none":"translate-x-full"),tabIndex:-1,"aria-labelledby":"drawer-navigation-label",children:[(0,s.jsx)("h5",{id:"drawer-navigation-label",className:"text-base font-semibold text-gray-500 uppercase dark:text-gray-400",children:l}),(0,s.jsxs)("button",{type:"button","data-drawer-hide":"drawer-navigation","aria-controls":"drawer-navigation",className:"text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm p-1.5 absolute top-2.5 end-2.5 inline-flex items-center dark:hover:bg-gray-600 dark:hover:text-white",onClick:i,children:[(0,s.jsx)("svg",{"aria-hidden":"true",className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})}),(0,s.jsx)("span",{className:"sr-only",children:"Close menu"})]}),(0,s.jsx)("div",{className:"py-4 overflow-y-auto flex flex-col gap-6",children:r})]})}},7969:(e,t,r)=>{"use strict";r.d(t,{Np:()=>n,Pt:()=>d});var s=r(5155),i=r(6094);let l={[i.AI.High]:4,[i.AI.Medium]:3,[i.AI.Low]:2,[i.AI.Info]:1},n=(e,t)=>l[e]-l[t],a={[i.AI.High]:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300",[i.AI.Medium]:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-300",[i.AI.Low]:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300",[i.AI.Info]:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300"},c={[i.AI.High]:"border border-red-200 dark:border-red-700",[i.AI.Medium]:"border border-orange-200 dark:border-orange-700",[i.AI.Low]:"border border-yellow-200 dark:border-yellow-700",[i.AI.Info]:"border border-blue-200 dark:border-blue-700"},d=e=>{let{severity:t,count:r,Element:i="span",onClick:l,selected:n=!1}=e,d=a[t];return n&&(d="".concat(d," ").concat(c[t])),(0,s.jsxs)(i,{className:"text-sm max-sm:text-xs font-medium me-2 px-2.5 py-0.5 rounded-sm ".concat(d),onClick:l,children:[(0,s.jsx)("span",{children:t}),!isNaN(Number(r))&&(0,s.jsx)("span",{className:"text-xs ml-1",children:r})]})}},8473:(e,t,r)=>{"use strict";r.d(t,{G:()=>d,GroupView:()=>o});var s=r(5155),i=r(7969),l=r(2272),n=r(2115),a=r(3522),c=r(7597);let d=e=>{let{group:t}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("section",{className:"w-full flex flex-col",children:(0,s.jsx)("div",{className:"relative overflow-x-auto shadow-md sm:rounded-lg",children:(0,s.jsxs)("table",{className:"w-full text-sm text-left rtl:text-right text-zinc-500 dark:text-zinc-400",children:[(0,s.jsx)("thead",{className:"text-xs text-zinc-700 uppercase bg-zinc-50 dark:bg-zinc-700 dark:text-zinc-400",children:(0,s.jsx)("tr",{children:(0,s.jsx)("th",{scope:"col",className:"px-6 py-3",children:"Description"})})}),(0,s.jsx)("tbody",{children:(0,s.jsx)("tr",{className:"even:bg-white even:dark:bg-zinc-900 odd:bg-zinc-50 odd:dark:bg-zinc-800 border-b dark:border-zinc-700 border-zinc-200 text-zinc-900 whitespace-nowrap dark:text-zinc-300 whitespace-pre-line",children:(0,s.jsx)("td",{className:"px-6 py-4 whitespace-pre-line",children:t.rule.description})},"".concat(t.id))})]})})}),(0,s.jsx)("section",{className:"w-full flex flex-col",children:(0,s.jsx)("div",{className:"relative overflow-x-auto shadow-md sm:rounded-lg",children:(0,s.jsxs)("table",{className:"w-full text-sm text-left rtl:text-right text-zinc-500 dark:text-zinc-400",children:[(0,s.jsx)("thead",{className:"text-xs text-zinc-700 uppercase bg-zinc-50 dark:bg-zinc-700 dark:text-zinc-400",children:(0,s.jsx)("tr",{children:(0,s.jsx)("th",{scope:"col",className:"px-6 py-3",children:"ℹ️ Check"})})}),(0,s.jsx)("tbody",{children:(0,s.jsx)("tr",{className:"even:bg-white even:dark:bg-zinc-900 odd:bg-zinc-50 odd:dark:bg-zinc-800 border-b dark:border-zinc-700 border-zinc-200 text-zinc-900 whitespace-nowrap dark:text-zinc-300 whitespace-pre-line",children:(0,s.jsx)("td",{className:"px-6 py-4 whitespace-pre-line",children:t.rule.check})},"".concat(t.id))})]})})}),(0,s.jsx)("section",{className:"w-full flex flex-col",children:(0,s.jsx)("div",{className:"relative overflow-x-auto shadow-md sm:rounded-lg",children:(0,s.jsxs)("table",{className:"w-full text-sm text-left rtl:text-right text-zinc-500 dark:text-zinc-400",children:[(0,s.jsx)("thead",{className:"text-xs text-zinc-700 uppercase bg-zinc-50 dark:bg-zinc-700 dark:text-zinc-400",children:(0,s.jsx)("tr",{children:(0,s.jsx)("th",{scope:"col",className:"px-6 py-3",children:"✔️ Fix"})})}),(0,s.jsx)("tbody",{children:(0,s.jsx)("tr",{className:"even:bg-white even:dark:bg-zinc-900 odd:bg-zinc-50 odd:dark:bg-zinc-800 border-b dark:border-zinc-700 border-zinc-200 text-zinc-900 whitespace-nowrap dark:text-zinc-300 whitespace-pre-line",children:(0,s.jsx)("td",{className:"px-6 py-4 whitespace-pre-line",children:t.rule.fixText})},"".concat(t.id))})]})})})]})},o=e=>{let{stigId:t,groupId:r,classification:o}=e,u=(0,l.KR)(),x=u.groups.find(e=>e.id===r);return x?(0,s.jsxs)(n.Suspense,{children:[(0,s.jsx)(a.B,{stigId:t,group:x}),(0,s.jsxs)("section",{className:"w-full flex flex-col",children:[(0,s.jsx)("h1",{className:"text-3xl my-6",children:x.rule.title}),(0,s.jsx)("div",{className:"relative overflow-x-auto shadow-sm sm:rounded-lg",children:(0,s.jsx)(c.XI,{tableHeaders:[{text:"Severity"},{text:"Group ID"},{text:"Group Title",className:"max-md:hidden"},{text:"Version"},{text:"Rule ID",className:"max-md:hidden"},{text:"Date",className:"max-lg:hidden"},{text:"STIG Version",className:"max-lg:hidden"}],tableBody:[{classNames:[null,null,"max-md:hidden",null,"max-md:hidden","max-lg:hidden","max-lg:hidden"],values:[x.rule.severity,x.id,x.title,x.rule.version,x.rule.id,u.date,u.version],columns:[(0,s.jsx)(i.Pt,{severity:x.rule.severity}),x.id,x.title,x.rule.version,x.rule.id,u.date,u.version]}]})})]}),(0,s.jsx)(d,{group:x})]}):null}}}]);