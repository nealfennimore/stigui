(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[766],{3522:(e,t,r)=>{"use strict";r.d(t,{B:()=>n});var s=r(5155),a=r(4125),l=r(6874),i=r.n(l);let n=e=>{let{stigId:t,group:r,editor:l}=e,n=(0,a.u2)(),d=l?[{href:"/editor",text:"Checklists"}]:[{href:"/stigs",text:"STIGs"}];if(t){let e=n.byId(t);d.push({href:"/stigs/".concat(t),text:"".concat(e.title)})}return r&&d.push({href:"/stigs/".concat(t,"/groups/").concat(r.id),text:"".concat(r.id)}),(0,s.jsx)("aside",{className:"flex flex-row items-center justify-start w-full",children:d.map((e,t)=>(0,s.jsxs)("span",{children:[(0,s.jsx)(i(),{className:"text-sm text-zinc-400",href:e.href,"aria-disabled":e.disabled,tabIndex:60,children:e.text}),t<d.length-1&&(0,s.jsxs)("span",{className:"text-sm mx-2 text-zinc-300",children:[" ",">"," "]})]},t))})}},3783:(e,t,r)=>{Promise.resolve().then(r.bind(r,4675))},4675:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>V});var s=r(5155),a=r(6094),l=r(2115);let i=e=>{var t,r,i,n,d,c,o,u;let{rule:x}=e;if(!x)return null;let[h,m]=(0,l.useState)(null!=(o=null==(r=x.overrides)||null==(t=r.severity)?void 0:t.severity)?o:x.severity);return(0,s.jsxs)("section",{className:"my-4",children:[(0,s.jsx)("h3",{className:"py-3",children:"ℹ️ Check"}),(0,s.jsx)("p",{className:"text-sm whitespace-pre-line",children:x.check_content}),(0,s.jsx)("h3",{className:"py-3",children:"✔️ Fix"}),(0,s.jsx)("p",{className:"text-sm whitespace-pre-line",children:x.fix_text}),(0,s.jsxs)("div",{className:"flex gap-6 mt-6 items-center",children:[(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{className:"mr-2",htmlFor:"status",children:"Status"}),(0,s.jsxs)("select",{defaultValue:x.status,id:"status",name:"rule.".concat(x.uuid,".status"),className:"border-2 border-zinc-300 dark:border-zinc-700 rounded-md p-2 text-zinc-900 dark:text-zinc-300 bg-white dark:bg-zinc-800",children:[(0,s.jsx)("option",{value:"not_a_finding",children:"Not a Finding"}),(0,s.jsx)("option",{value:"not_applicable",children:"Not Applicable"}),(0,s.jsx)("option",{value:"not_reviewed",children:"Not Reviewed"}),(0,s.jsx)("option",{value:"open",children:"Open"})]})]}),(0,s.jsxs)("div",{className:"flex gap-6 items-center",children:[(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{className:"mr-2",htmlFor:"severity",children:"Severity"}),(0,s.jsxs)("select",{defaultValue:null!=(u=null==(n=x.overrides)||null==(i=n.severity)?void 0:i.severity)?u:x.severity,onChange:e=>{m(e.target.value)},id:"severity",name:"rule.".concat(x.uuid,".overrides.severity.severity"),className:"border-2 border-zinc-300 dark:border-zinc-700 rounded-md p-2 text-zinc-900 dark:text-zinc-300 bg-white dark:bg-zinc-800",children:[(0,s.jsx)("option",{value:a.AI.High,children:"High/CAT I"}),(0,s.jsx)("option",{value:a.AI.Medium,children:"Medium/CAT II"}),(0,s.jsx)("option",{value:a.AI.Low,children:"Low/CAT III"}),(0,s.jsx)("option",{value:a.AI.Info,children:"Info/CAT IV"})]})]}),h!==x.severity&&(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{htmlFor:"reason",children:"Severity Override Reason"}),(0,s.jsx)("input",{id:"reason",name:"rule.".concat(x.uuid,".overrides.severity.reason"),className:"w-full border-2 border-zinc-300 dark:border-zinc-700 rounded-md p-2 text-zinc-900 dark:text-zinc-300 bg-white dark:bg-zinc-800",defaultValue:null==(c=x.overrides)||null==(d=c.severity)?void 0:d.reason})]})]})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)("label",{className:"mt-4",htmlFor:"comments",children:"Comments"}),(0,s.jsx)("textarea",{id:"comments",name:"rule.".concat(x.uuid,".comments"),className:"w-full h-32 border-2 border-zinc-300 dark:border-zinc-700 rounded-md p-2 text-zinc-900 dark:text-zinc-300 bg-white dark:bg-zinc-800",defaultValue:x.comments}),(0,s.jsx)("label",{className:"mt-4",htmlFor:"finding_details",children:"Finding Details"}),(0,s.jsx)("textarea",{id:"finding_details",name:"rule.".concat(x.uuid,".finding_details"),className:"w-full h-32 border-2 border-zinc-300 dark:border-zinc-700 rounded-md p-2 text-zinc-900 dark:text-zinc-300 bg-white dark:bg-zinc-800",defaultValue:x.finding_details})]})]},x.uuid)};var n=r(6792),d=r(5383),c=r(4754),o=r(3522);let u=e=>{let{checklist:t}=e,[r,i]=(0,l.useState)(!1),[n,d]=(0,l.useState)(t.target_data.is_web_database);return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{id:"accordion-arrow-icon","data-accordion":"open",className:"mb-6",children:[(0,s.jsx)("h2",{id:"accordion-arrow-icon-heading-2",children:(0,s.jsxs)("button",{type:"button",className:"flex items-center justify-between w-full p-5 font-medium rtl:text-right text-zinc-500 border border-zinc-200 focus:ring-4 focus:ring-zinc-200 dark:focus:ring-zinc-800 dark:border-zinc-800 dark:text-zinc-400 hover:bg-zinc-100 dark:hover:bg-zinc-800 gap-3 uppercase","aria-expanded":"false","aria-controls":"accordion-arrow-icon-body-2",onClick:()=>i(!r),children:[(0,s.jsx)("span",{children:"Metadata"}),(0,s.jsx)("svg",{className:"w-4 h-4 shrink-0 -me-0.5"+(r?" rotate-180":""),"aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 10 6",children:(0,s.jsx)("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5 5 1 1 5"})})]})}),(0,s.jsx)("div",{className:r?"":"hidden",children:(0,s.jsx)("div",{className:"p-5 border border-t-0 border-zinc-200 dark:border-zinc-800",children:(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4 max-md:grid-cols-1",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block",children:"Target Type:"}),(0,s.jsx)("select",{name:"target_data.".concat(t.id,".target_type"),defaultValue:t.target_data.target_type,className:"border-2 border-zinc-300 dark:border-zinc-700 rounded-md p-2 text-zinc-900 dark:text-zinc-300 bg-white dark:bg-zinc-800",children:Object.values(a.yK).map(e=>(0,s.jsx)("option",{value:e,children:e},e))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block",children:"Host Name:"}),(0,s.jsx)("input",{type:"text",name:"target_data.".concat(t.id,".host_name"),defaultValue:t.target_data.host_name,className:"w-full border-2 border-zinc-300 dark:border-zinc-700 rounded-md p-2 text-zinc-900 dark:text-zinc-300 bg-white dark:bg-zinc-800"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block",children:"IP Address:"}),(0,s.jsx)("input",{type:"text",name:"target_data.".concat(t.id,".ip_address"),defaultValue:t.target_data.ip_address,className:"w-full border-2 border-zinc-300 dark:border-zinc-700 rounded-md p-2 text-zinc-900 dark:text-zinc-300 bg-white dark:bg-zinc-800"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block",children:"MAC Address:"}),(0,s.jsx)("input",{type:"text",name:"target_data.".concat(t.id,".mac_address"),defaultValue:t.target_data.mac_address,className:"w-full border-2 border-zinc-300 dark:border-zinc-700 rounded-md p-2 text-zinc-900 dark:text-zinc-300 bg-white dark:bg-zinc-800"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block",children:"FQDN:"}),(0,s.jsx)("input",{type:"text",name:"target_data.".concat(t.id,".fqdn"),defaultValue:t.target_data.fqdn,className:"w-full border-2 border-zinc-300 dark:border-zinc-700 rounded-md p-2 text-zinc-900 dark:text-zinc-300 bg-white dark:bg-zinc-800"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block",children:"Comments:"}),(0,s.jsx)("textarea",{name:"target_data.".concat(t.id,".comments"),defaultValue:t.target_data.comments,className:"w-full border-2 border-zinc-300 dark:border-zinc-700 rounded-md p-2 text-zinc-900 dark:text-zinc-300 bg-white dark:bg-zinc-800",rows:3})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block",children:"Role:"}),(0,s.jsx)("select",{name:"target_data.".concat(t.id,".role"),defaultValue:t.target_data.role,className:"border-2 border-zinc-300 dark:border-zinc-700 rounded-md p-2 text-zinc-900 dark:text-zinc-300 bg-white dark:bg-zinc-800",children:Object.values(a.Xh).map(e=>(0,s.jsx)("option",{value:e,children:e},e))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block",children:"Technology Area:"}),(0,s.jsx)("select",{name:"target_data.".concat(t.id,".technology_area"),defaultValue:t.target_data.technology_area,className:"border-2 border-zinc-300 dark:border-zinc-700 rounded-md p-2 text-zinc-900 dark:text-zinc-300 bg-white dark:bg-zinc-800",children:Object.values(a.sg).map(e=>(0,s.jsx)("option",{value:e,children:e},e))})]}),(0,s.jsx)("div",{children:(0,s.jsxs)("label",{className:"block",children:[(0,s.jsx)("input",{type:"checkbox",name:"target_data.".concat(t.id,".is_web_database"),defaultChecked:t.target_data.is_web_database,onChange:e=>d(e.target.checked)}),(0,s.jsx)("span",{className:"ml-2",children:"Is Web Database"})]})}),(0,s.jsx)("div",{}),n&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block",children:"Web DB Site:"}),(0,s.jsx)("input",{type:"text",name:"target_data.".concat(t.id,".web_db_site"),defaultValue:t.target_data.web_db_site,className:"w-full border-2 border-zinc-300 dark:border-zinc-700 rounded-md p-2 text-zinc-900 dark:text-zinc-300 bg-white dark:bg-zinc-800"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block",children:"Web DB Instance:"}),(0,s.jsx)("input",{type:"text",name:"target_data.".concat(t.id,".web_db_instance"),defaultValue:t.target_data.web_db_instance,className:"w-full border-2 border-zinc-300 dark:border-zinc-700 rounded-md p-2 text-zinc-900 dark:text-zinc-300 bg-white dark:bg-zinc-800",disabled:!t.target_data.is_web_database})]})]})]})})})]})})};var x=r(7969);let h={[a.nW.Open]:4,[a.nW.NotReviewed]:3,[a.nW.NotAFinding]:2,[a.nW.NotApplicable]:1},m=(e,t)=>h[e]-h[t],b={[a.nW.Open]:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300",[a.nW.NotReviewed]:"bg-zinc-100 text-zinc-800 dark:bg-zinc-900 dark:text-zinc-300",[a.nW.NotAFinding]:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",[a.nW.NotApplicable]:"bg-stone-100 text-stone-800 dark:bg-stone-900 dark:text-stone-300"},g={[a.nW.Open]:"border border-red-200 dark:border-red-700",[a.nW.NotReviewed]:"border border-zinc-200 dark:border-zinc-700",[a.nW.NotAFinding]:"border border-green-200 dark:border-green-700",[a.nW.NotApplicable]:"border border-stone-200 dark:border-stone-700"},f=e=>{let{status:t,Element:r="span",onClick:a,selected:l=!1,count:i}=e,n=b[t];return l&&(n="".concat(n," ").concat(g[t])),(0,s.jsxs)(r,{className:"text-sm max-sm:text-xs font-medium me-2 px-2.5 py-0.5 rounded-sm whitespace-nowrap ".concat(n),onClick:a,children:[(0,s.jsx)("span",{children:t.replaceAll("_"," ")}),!isNaN(Number(i))&&(0,s.jsx)("span",{className:"text-xs ml-1",children:i})]})};var v=r(7597);let p=[v.AG,x.Np,m,null],j=[null,null,v.kv,null],k=(e,t)=>{let r=Object.keys(e),s=Object.keys(t);if(r.length!==s.length)return!1;for(let s of r){let r=null==e?void 0:e[s],a=null==t?void 0:t[s];if("object"==typeof r&&"object"==typeof a){if(!k(r,a))return!1}else if(r!==a)return!1}return!0},w=e=>{let t=new Blob([a.U$.checklistToJson(e)],{type:"application/json"}),r=URL.createObjectURL(t);(0,c.R)(r,"checklist-".concat(e.id,".cklb")),URL.revokeObjectURL(r)},N=[{text:"Status"},{text:"Severity"},{text:"Title"},{text:"Description",className:"max-lg:hidden"}],y=e=>{var t;let{checklistId:r}=e,[a,h]=(0,l.useState)(null),b=(0,l.useRef)(null),[g,y]=(0,l.useState)(new Set),[_,z]=(0,l.useState)(new Set),[I,A]=(0,l.useState)(null);(0,l.useEffect)(()=>{(async()=>{h(await d.IDB.exportChecklist(r))})()},[r]);let C=(0,l.useMemo)(()=>a?a.stigs.flatMap(e=>e.rules).reduce((e,t)=>(e[t.uuid]=t,e),{}):{},[a]),S=(0,l.useMemo)(()=>C?Object.values(C).filter(e=>{var t,r,s;let a=null!=(s=null==(r=e.overrides)||null==(t=r.severity)?void 0:t.severity)?s:e.severity,l=e.status;return(!(g.size>0)||!!g.has(a))&&(!(_.size>0)||!!_.has(l))}):[],[C,g,_]),O=(0,l.useMemo)(()=>{let e={severity:{},status:{}};return Object.values(C).forEach(t=>{var r,s,a;let l=null!=(a=null==(s=t.overrides)||null==(r=s.severity)?void 0:r.severity)?a:t.severity,i=t.status;e.severity[l]||(e.severity[l]=0),e.severity[l]++,e.status[i]||(e.status[i]=0),e.status[i]++}),{severity:Object.entries(e.severity).sort((e,t)=>{let[r]=e,[s]=t;return(0,x.Np)(s,r)}),status:Object.entries(e.status).sort((e,t)=>{let[r]=e,[s]=t;return m(s,r)})}},[C]),R=(0,l.useMemo)(()=>null!==I&&I>-1?null==S?void 0:S[I]:null,[I]),B=(0,l.useMemo)(()=>e=>{if(!b.current)return;let t=new FormData(b.current),s={rule:{},target_data:{}},l=[];for(let[e,r]of t.entries()){let[t,a,...l]=e.split(".");if("target_data"!==t&&"rule"!==t)continue;let i=l.length,n=C[a];if("rule"===t){if(1===i&&(null==n?void 0:n[l[0]])===r)continue;s.rule[a]||(s.rule[a]={});let e=s.rule[a];for(let[t,s]of l.entries())void 0===e[s]&&i>1&&(e[s]={}),t===i-1?e[s]=r:e=e[s]}else if("target_data"===t){s.target_data[a]||(s.target_data[a]={is_web_database:!1});let e=l[0];"is_web_database"===e?s.target_data[a][e]="true"===r||"on"===r:s.target_data[a][e]=r}}for(let[e,t]of Object.entries(s.rule)){if(1===Object.keys(t).length&&t.overrides&&k(t.overrides,C[e].overrides))continue;let r={...C[e],...t,uuid:e};l.push(d.IDB.rules.put(r))}for(let[e,t]of Object.entries(s.target_data)){if(k(t,null==a?void 0:a.target_data))continue;let e={...a,target_data:{...null==a?void 0:a.target_data,...t}};l.push(d.IDB.checklists.put(e))}Promise.all(l).then(async()=>{h(await d.IDB.exportChecklist(r))})},[S,C,R]),D=(0,l.useMemo)(()=>(0,c.s)(B,500),[B]),E=(0,l.useMemo)(()=>S.map((e,t)=>{var r,a,l,i,n,d;return{onClick:()=>A(t),values:[e.status,null!=(n=null==(a=e.overrides)||null==(r=a.severity)?void 0:r.severity)?n:e.severity,e.rule_title,e.discussion],columns:[(0,s.jsx)(f,{status:e.status}),(0,s.jsx)(x.Pt,{severity:null!=(d=null==(i=e.overrides)||null==(l=i.severity)?void 0:l.severity)?d:e.severity}),e.rule_title,e.discussion],classNames:[null,null,null,"max-lg:hidden"]}}),[S]);return(0,s.jsx)(l.Suspense,{fallback:(0,s.jsx)("div",{children:"Loading..."}),children:(0,s.jsxs)("form",{ref:b,onSubmit:e=>e.preventDefault(),onChange:D,children:[(0,s.jsx)(o.B,{editor:!0}),(0,s.jsx)(n.B,{isOpen:null!==R,onClick:()=>A(null),headerText:null!=(t=null==R?void 0:R.rule_title)?t:"Rule Details",children:(0,s.jsx)(i,{rule:R})}),null==a?void 0:a.stigs.map(e=>(0,s.jsxs)("div",{children:[(0,s.jsxs)("section",{className:"my-4 w-full flex flex-col",children:[(0,s.jsx)("h1",{className:"text-3xl my-6",children:null==a?void 0:a.title}),(0,s.jsx)(u,{checklist:a}),(0,s.jsxs)("div",{className:"w-full flex flex-col justify-between",children:[(0,s.jsxs)("div",{className:"text-zinc-600 dark:text-zinc-500 text-xs mr-4 flex justify-between",children:[(0,s.jsx)("span",{children:e.display_name}),(0,s.jsxs)("span",{children:["Version ",e.version]})]}),(0,s.jsxs)("div",{className:"text-zinc-600 dark:text-zinc-500 text-xs mr-4 flex justify-between",children:[(0,s.jsxs)("span",{children:[e.size," rules"]}),(0,s.jsx)("span",{children:e.release_info})]}),(0,s.jsx)("div",{className:"text-zinc-600 dark:text-zinc-500 text-xs mr-4 flex justify-end",children:(0,s.jsx)("button",{onClick:()=>w(a),className:"text-zinc-600 dark:text-zinc-500 text-xs flex flex-col",children:"CKLB ⬇️"})})]})]}),(0,s.jsxs)("aside",{className:"w-full flex justify-between items-center my-6",children:[(0,s.jsx)("div",{children:O.severity.map(e=>{let[t,r]=e;return(0,s.jsx)(x.Pt,{severity:t,count:r,Element:"button",selected:g.has(t),onClick:()=>{let e=new Set(g);e.has(t)?e.delete(t):e.add(t),y(e)}},t)})}),(0,s.jsx)("div",{children:O.status.map(e=>{let[t,r]=e;return(0,s.jsx)(f,{status:t,count:r,Element:"button",selected:_.has(t),onClick:()=>{let e=new Set(_);e.has(t)?e.delete(t):e.add(t),z(e)}},t)})})]}),(0,s.jsx)("section",{className:"w-full flex flex-col",children:(0,s.jsx)(v.XI,{formRef:b,filters:j,sorters:p,tableHeaders:N,tableBody:E,initialOrders:[v.pH.NONE,v.pH.DESC,v.pH.NONE,v.pH.NONE]})})]},e.uuid))]})})};var _=r(6874),z=r.n(_);let I=[v.AG,v.AG,v.AG],A=[null,v.kv,null],C=()=>{let[e,t]=(0,l.useState)(null);(0,l.useEffect)(()=>{(async()=>{let e=await d.IDB.checklists.getAll();t(await Promise.all(e.map(e=>d.IDB.exportChecklist(e.id))))})()},[]);let r=(0,l.useMemo)(()=>[{text:"ID",filterable:!1},{text:"Title",filterable:!0,className:"text-center"},{text:"CKLB Version",filterable:!1,className:"max-md:hidden"}],[]),a=(0,l.useMemo)(()=>{var t;return null!=(t=null==e?void 0:e.map(e=>({values:[e.id,e.title,e.cklb_version],columns:[(0,s.jsx)(z(),{className:"flex flex-col",href:"/editor?id=".concat(e.id),children:e.id}),e.title,e.cklb_version],classNames:[null,null,null]})))?t:[]},[e]);return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("section",{className:"w-full flex flex-col",children:(0,s.jsx)("div",{className:"relative overflow-x-auto shadow-md sm:rounded-lg",children:(0,s.jsx)(v.XI,{sorters:I,filters:A,tableHeaders:r,tableBody:a,initialOrders:[v.pH.NONE,v.pH.NONE,v.pH.NONE],formRef:null})})})})},S=()=>(0,s.jsx)("footer",{className:"bg-white dark:bg-zinc-900 border-t border-zinc-200 dark:border-zinc-700",children:(0,s.jsxs)("div",{className:"w-full max-w-screen-xl mx-auto p-4 md:py-8",children:[(0,s.jsx)("span",{className:"block text-sm text-zinc-500 sm:text-center",children:(0,s.jsxs)("div",{className:"flex flex-row items-center justify-center",children:["Not affiliated with DISA.",(0,s.jsx)("a",{href:"https://github.com/nealfennimore/stig",className:"block text-sm text-zinc-500 sm:text-center",tabIndex:100,children:(0,s.jsx)("svg",{className:"w-5 h-5 mx-4","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 20 20",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M10 .333A9.911 9.911 0 0 0 6.866 19.65c.5.092.678-.215.678-.477 0-.237-.01-1.017-.014-1.845-2.757.6-3.338-1.169-3.338-1.169a2.627 2.627 0 0 0-1.1-1.451c-.9-.615.07-.6.07-.6a2.084 2.084 0 0 1 1.518 1.021 2.11 2.11 0 0 0 2.884.823c.044-.503.268-.973.63-1.325-2.2-.25-4.516-1.1-4.516-4.9A3.832 3.832 0 0 1 4.7 7.068a3.56 3.56 0 0 1 .095-2.623s.832-.266 2.726 1.016a9.409 9.409 0 0 1 4.962 0c1.89-1.282 2.717-1.016 2.717-1.016.366.83.402 1.768.1 2.623a3.827 3.827 0 0 1 1.02 2.659c0 3.807-2.319 4.644-4.525 4.889a2.366 2.366 0 0 1 .673 1.834c0 1.326-.012 2.394-.012 2.72 0 .263.18.572.681.475A9.911 9.911 0 0 0 10 .333Z",clipRule:"evenodd"})})})]})}),(0,s.jsxs)("span",{className:"block text-sm text-zinc-500 sm:text-center flex flex-row items-center justify-center",children:["\xa9 2025"," ",(0,s.jsx)("a",{href:"https://neal.codes",className:"hover:underline mx-1",tabIndex:70,children:"neal.codes"}),"All Rights Reserved."]})]})});function O(e){let{children:t}=e;return(0,s.jsxs)("div",{className:"grid grid-rows-[20px_1fr_20px] items-center justify-items-center p-8 md:p-6 max-sm:p-2 pb-20 gap-16 font-[family-name:var(--font-geist-sans)]",children:[(0,s.jsx)("main",{className:"flex flex-col gap-8 row-start-2 items-center sm:items-start max-w-screen-xl",children:t}),(0,s.jsx)("footer",{className:"row-start-3 flex gap-6 flex-wrap items-center justify-center"})]})}var R=r(2350);let B=(0,l.createContext)(null);function D(e){let{children:t,value:r}=e;return(0,s.jsx)(B.Provider,{value:r,children:t})}function E(e){let{checklistId:t,children:r}=e,a=d.IDB.exportChecklist(t);return(0,s.jsx)(D,{value:a,children:r})}var P=r(4125),L=r(5695);function M(){let e=(0,L.useSearchParams)().get("id");return e?(0,s.jsxs)(P.default,{children:[(0,s.jsx)(R.Navigation,{}),(0,s.jsx)(O,{children:(0,s.jsx)(E,{checklistId:e,children:(0,s.jsx)(y,{checklistId:e})})}),(0,s.jsx)(S,{})]}):(0,s.jsxs)(P.default,{children:[(0,s.jsx)(R.Navigation,{}),(0,s.jsx)(O,{children:(0,s.jsx)(C,{})}),(0,s.jsx)(S,{})]})}function V(){return(0,s.jsx)(l.Suspense,{children:(0,s.jsx)(M,{})})}},5383:(e,t,r)=>{"use strict";let s;r.r(t),r.d(t,{IDB:()=>v,clear:()=>b,get:()=>h,getAll:()=>x,getDB:()=>d,getIndex:()=>u,getStore:()=>o,put:()=>m,version:()=>a});let a=1;var l,i,n=function(e){return e.CHECKLISTS="checklists",e.STIGS="stigs",e.RULES="rules",e.CHECKLIST_STIGS="checklist_stigs",e}(n||{});{let e=null==(i=window)||null==(l=i.indexedDB)?void 0:l.open("stigs",a);s=new Promise((t,r)=>{e.onerror=e=>{console.error("Can't use IndexDB"),r(e)},e.onsuccess=e=>{var r;t(null==(r=e.target)?void 0:r.result)},e.onupgradeneeded=function(e){var t;let r=null==(t=e.target)?void 0:t.result,s=r.createObjectStore("checklists",{keyPath:"id"});s.createIndex("title","title",{unique:!1}),s.createIndex("active","active",{unique:!1}),s.createIndex("mode","mode",{unique:!1});let a=r.createObjectStore("stigs",{keyPath:"uuid"});a.createIndex("stig_id","stig_id",{unique:!1}),a.createIndex("stig_name","stig_name",{unique:!1});let l=r.createObjectStore("rules",{keyPath:"uuid"});l.createIndex("group_id","group_id",{unique:!1}),l.createIndex("rule_id","rule_id",{unique:!1}),l.createIndex("stig_uuid","stig_uuid",{unique:!1}),l.createIndex("status","status",{unique:!1}),l.createIndex("severity","severity",{unique:!1});let i=r.createObjectStore("checklist_stigs",{keyPath:"id",autoIncrement:!0});i.createIndex("checklist_id","checklist_id",{unique:!1}),i.createIndex("stig_uuid","stig_uuid",{unique:!1}),i.createIndex("checklist_stig",["checklist_id","stig_uuid"],{unique:!0})}})}let d=function(){return s||Promise.reject("Can't use IndexDB")};var c=function(e){return e.READONLY="readonly",e.READWRITE="readwrite",e}(c||{});let o=async(e,t)=>(await d()).transaction(e,t).objectStore(e),u=async(e,t,r)=>(await o(e,t)).index(r),x=(e,t)=>async function(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,s=arguments.length>1?arguments[1]:void 0,a=await o(e,"readonly");t&&(a=a.index(t));let l=a.getAll(r,s);return new Promise((e,t)=>{l.onsuccess=()=>{e(l.result)},l.onerror=()=>{t()}})},h=(e,t)=>async r=>{let s=await o(e,"readonly");t&&(s=s.index(t));let a=s.get(r);return new Promise((e,t)=>{a.onsuccess=()=>{e(a.result)},a.onerror=()=>{t()}})},m=e=>async t=>{let r=await o(e,"readwrite");return new Promise((e,s)=>{let a=r.put(t);a.onsuccess=()=>{e(a.result)},a.onerror=()=>{s()}})},b=e=>async()=>{let t=await o(e,"readwrite");return new Promise((e,r)=>{let s=t.clear();s.onsuccess=()=>{e(!0)},s.onerror=()=>{r(!1)}})};class g{constructor(e,t){this.getAll=x(e,t),this.get=h(e,t)}}class f{constructor(e){this.table=e,this.getAll=x(e),this.get=h(e),this.put=m(e),this.clear=b(e),this.store=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"readonly";return o(e,t)}}}class v{static async exportChecklist(e){try{let t=await v.checklists.get(e);if(!t)throw Error("Checklist not found");let r=(await new g(v.checklistStigs.table,"checklist_id").getAll(e)).map(e=>e.stig_uuid),s=await Promise.all(r.map(e=>v.stigs.get(e))),a=new g(v.rules.table,"stig_uuid"),l=await r.reduce(async(e,t)=>{let r=await e,s=await a.getAll(t);return r[t]=s,r},Promise.resolve({}));return{...t,stigs:s.map(e=>({...e,rules:l[e.uuid],size:l[e.uuid].length}))}}catch(e){throw console.error("Error exporting checklist:",e),e}}static async importChecklist(e){try{let{stigs:t,...r}=e;for(let e of(await v.checklists.put(r),t)){let{rules:t,...s}=e;for(let e of(await v.stigs.put(s),await v.checklistStigs.put({checklist_id:r.id,stig_uuid:s.uuid}),t))e.uuid&&await v.rules.put(e)}return!0}catch(e){return console.error("Error importing checklist:",e),!1}}}v.checklists=new f("checklists"),v.stigs=new f("stigs"),v.rules=new f("rules"),v.checklistStigs=new f("checklist_stigs"),v.version=a,window.db=v},5695:(e,t,r)=>{"use strict";var s=r(8999);r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}}),r.o(s,"useSearchParams")&&r.d(t,{useSearchParams:function(){return s.useSearchParams}})},6792:(e,t,r)=>{"use strict";r.d(t,{B:()=>a});var s=r(5155);r(2115);let a=e=>{let{isOpen:t=!0,children:r,onClick:a,headerText:l=""}=e;return(0,s.jsxs)("aside",{id:"drawer-navigation",className:"fixed top-0 right-0 z-40 w-fit max-w-5xl h-screen p-4 overflow-y-auto transition-transform bg-white dark:bg-zinc-900 sm:max-w-screen border-l border-zinc-300 dark:border-zinc-700 ".concat(t?"transform-none":"translate-x-full"),tabIndex:-1,"aria-labelledby":"drawer-navigation-label",children:[(0,s.jsx)("h5",{id:"drawer-navigation-label",className:"text-base font-semibold text-gray-500 uppercase dark:text-gray-400",children:l}),(0,s.jsxs)("button",{type:"button","data-drawer-hide":"drawer-navigation","aria-controls":"drawer-navigation",className:"text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm p-1.5 absolute top-2.5 end-2.5 inline-flex items-center dark:hover:bg-gray-600 dark:hover:text-white",onClick:a,children:[(0,s.jsx)("svg",{"aria-hidden":"true",className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})}),(0,s.jsx)("span",{className:"sr-only",children:"Close menu"})]}),(0,s.jsx)("div",{className:"py-4 overflow-y-auto flex flex-col gap-6",children:r})]})}},7969:(e,t,r)=>{"use strict";r.d(t,{Np:()=>i,Pt:()=>c});var s=r(5155),a=r(6094);let l={[a.AI.High]:4,[a.AI.Medium]:3,[a.AI.Low]:2,[a.AI.Info]:1},i=(e,t)=>l[e]-l[t],n={[a.AI.High]:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300",[a.AI.Medium]:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-300",[a.AI.Low]:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300",[a.AI.Info]:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300"},d={[a.AI.High]:"border border-red-200 dark:border-red-700",[a.AI.Medium]:"border border-orange-200 dark:border-orange-700",[a.AI.Low]:"border border-yellow-200 dark:border-yellow-700",[a.AI.Info]:"border border-blue-200 dark:border-blue-700"},c=e=>{let{severity:t,count:r,Element:a="span",onClick:l,selected:i=!1}=e,c=n[t];return i&&(c="".concat(c," ").concat(d[t])),(0,s.jsxs)(a,{className:"text-sm max-sm:text-xs font-medium me-2 px-2.5 py-0.5 rounded-sm ".concat(c),onClick:l,children:[(0,s.jsx)("span",{children:t}),!isNaN(Number(r))&&(0,s.jsx)("span",{className:"text-xs ml-1",children:r})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[167,548,441,684,358],()=>t(3783)),_N_E=e.O()}]);